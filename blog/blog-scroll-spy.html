<!DOCTYPE html><html lang="ko" class="scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:locale" content="ko-KR"/><meta property="og:site_name" content="minjae blog"/><meta name="author" content="Minjae Kim"/><title>블로그 스크롤 스파이(TOC) 구현기</title><meta name="robots" content="index,follow"/><meta name="description" content="Intersection observer 방식과 계산된 scrollY를 활용하는 방법 모두 확인해보자."/><meta property="og:title" content="블로그 스크롤 스파이(TOC) 구현기"/><meta property="og:description" content="Intersection observer 방식과 계산된 scrollY를 활용하는 방법 모두 확인해보자."/><meta property="og:url" content="https://mxx-kor.github.io/blog/blog-scroll-spy"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2023-11-20T11:04:00.000Z"/><meta property="article:modified_time" content="2023-11-21T08:33:00.000Z"/><meta property="article:author" content="https://github.com/mxx-kor"/><meta property="article:tag" content="개인 프로젝트"/><meta property="article:tag" content="React"/><meta property="og:image" content="https://avatars.githubusercontent.com/u/82329983?v=4"/><meta property="og:image:width" content="285"/><meta property="og:image:height" content="167"/><link rel="canonical" href="https://mxx-kor.github.io/blog/blog-scroll-spy"/><meta name="next-head-count" content="21"/><meta name="google-site-verification" content="XJtOBpU5U3tModhdmzxqFas0xo0_saGhnWxPEAC-NHk"/><link rel="preload" href="/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/de5f35e2b8d4bc52-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/91d855b67a63e74f-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/ae11f023272d3641-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/bff605305ca72295-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/0bb6dc123aa42fb6-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/c1dc044a02b6e610.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c1dc044a02b6e610.css" data-n-g=""/><link rel="preload" href="/_next/static/css/3236e1a678526afc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3236e1a678526afc.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script defer="" src="/_next/static/chunks/3607272e.2e699c1bc0d79620.js"></script><script defer="" src="/_next/static/chunks/853.cf688abe519004d8.js"></script><script defer="" src="/_next/static/chunks/794.2b85bc94a9efc2f7.js"></script><script src="/_next/static/chunks/webpack-76ed0eb490c6144f.js" defer=""></script><script src="/_next/static/chunks/framework-305cb810cde7afac.js" defer=""></script><script src="/_next/static/chunks/main-34577be56dd3d97c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-8fc5a886d40f199c.js" defer=""></script><script src="/_next/static/chunks/239-569a8cd56c4de129.js" defer=""></script><script src="/_next/static/chunks/551-b3fc15b50b249083.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-d726acd484bdc84f.js" defer=""></script><script src="/_next/static/B0Yfy3owCS4DCUZlgyOKx/_buildManifest.js" defer=""></script><script src="/_next/static/B0Yfy3owCS4DCUZlgyOKx/_ssgManifest.js" defer=""></script><style id="__jsx-273604385">:root{--font-sans:'__Inter_a64ecd', '__Inter_Fallback_a64ecd';--font-spoqa:'__fontSpoqa_fca923', '__fontSpoqa_Fallback_fca923'}</style></head><body class="text-primary bg-primary transition-[background]"><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="container mx-auto max-w-screen-md px-6 font-spoqa"><header class="flex justify-between py-6"><ul class="flex items-center gap-4"><li class="font-sans font-medium"><a class="text-tertiary hover:text-secondary" href="/">Home</a></li><li class="font-sans font-medium"><a class="text-primary font-bold hover:text-secondary" href="/blog">Blog</a></li><li class="font-sans font-medium"><a class="text-tertiary hover:text-secondary" href="/archives">Archives</a></li><li class="font-sans font-medium"><a class="text-tertiary hover:text-secondary" href="/about">About</a></li></ul></header><div class="fixed left-0 top-0 z-10 h-1.5 w-full origin-top-left bg-gradient-to-r from-blue-400 to-sky-600 dark:from-stone-700 dark:to-stone-200" style="transform:scaleX(0) translateZ(0)"></div><a class="mb-6 inline-block" href="/blog"><button aria-label="Back to posts" type="button" class="hover:bg-secondary flex h-9 items-center justify-center rounded-lg transition-all w-32"><div class="flex items-center text-md gap-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"></path><path d="M8 7v4L2 6l6-5v4h5a8 8 0 1 1 0 16H4v-2h9a6 6 0 1 0 0-12H8z"></path></g></svg><span>Back to posts</span></div></button></a><article><aside class="sticky top-12 hidden xl:block"><div class="absolute left-full w-64 rounded-2xl p-4"><h2 class="tracking-tight mb-4 text-lg font-bold">목차</h2><ul class="mb-2"><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all text-base hover:font-normal" href="/blog/blog-scroll-spy#3b17e50965624bc1a34bebfb0253b731">TOC(Table of contents)</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all text-base hover:font-normal" href="/blog/blog-scroll-spy#aed5012a26a346e197761ca64c703db8">스크롤 스파이</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all ml-4 text-sm hover:font-normal" href="/blog/blog-scroll-spy#845a2c9c9a9041aba263f065e49b24ac">Intersection Observer 활용</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all ml-10 text-sm hover:font-normal" href="/blog/blog-scroll-spy#93705485f6034db690d4de7c99f21693">구현 코드</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all ml-10 text-sm hover:font-normal" href="/blog/blog-scroll-spy#4c6f88e49b154b7aa2ba32043b3ddd05">문제점</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all ml-4 text-sm hover:font-normal" href="/blog/blog-scroll-spy#c7dc16bc69cd4bdca5d6dba1eea7d72c">h 태그의 위치를 구하고 계산하여 활용</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all ml-10 text-sm hover:font-normal" href="/blog/blog-scroll-spy#d3ac7588ee1e4531a47b5e6eb87e2e64">구현 코드</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all ml-10 text-sm hover:font-normal" href="/blog/blog-scroll-spy#b111b199fdb740d8ae7146187b0c1df4">문제점</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all text-base hover:font-normal" href="/blog/blog-scroll-spy#2dade119a1ea4891af5e2b063463879e">마치며</a></li></ul><div class="bg-tag flex w-44 justify-between gap-2 rounded-xl px-4"><a href="/blog"><button aria-label="icon-button" type="button" class="hover:bg-secondary flex h-9 w-9 items-center justify-center rounded-lg transition-all"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"></path><path d="M8 7v4L2 6l6-5v4h5a8 8 0 1 1 0 16H4v-2h9a6 6 0 1 0 0-12H8z"></path></g></svg></button></a><button aria-label="icon-button" type="button" class="hover:bg-secondary flex h-9 w-9 items-center justify-center rounded-lg transition-all"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="22" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355a8 8 0 0 0-12.6 0l-112 141.7a7.98 7.98 0 0 0 6.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z"></path></svg></button><button aria-label="icon-button" type="button" class="hover:bg-secondary flex h-9 w-9 items-center justify-center rounded-lg transition-all"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="22" width="22" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"></path><path d="M14 22.5L11.2 19H6a1 1 0 0 1-1-1V7.103a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1V18a1 1 0 0 1-1 1h-5.2L14 22.5zm1.839-5.5H21V8.103H7V17H12.161L14 19.298 15.839 17zM2 2h17v2H3v11H1V3a1 1 0 0 1 1-1z"></path></g></svg></button></div></div></aside><section><h1 class="mb-2 break-keep text-center text-3xl font-bold">블로그 스크롤 스파이(TOC) 구현기</h1><div class="flex items-center gap-1 text-tertiary mb-2 justify-center text-sm"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg><span>2023.11.20</span></div><div class="mb-4 flex justify-center gap-2"><a href="/archives/tags/%EA%B0%9C%EC%9D%B8%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8"><span class="inline-flex items-center rounded-md px-2 py-1 text-tertiary bg-tag text-xs font-medium hover:bg-secondary ring-1 ring-inset ring-gray-500/10 transition-all">개인 프로젝트</span></a><a href="/archives/tags/React"><span class="inline-flex items-center rounded-md px-2 py-1 text-tertiary bg-tag text-xs font-medium hover:bg-secondary ring-1 ring-inset ring-gray-500/10 transition-all">React</span></a></div></section><section class="transition-all xl:hidden"><hr class="border-neutral-300 w-full border-1 mb-4 dark:border-neutral-400"/><h2 class="text-2xl font-bold tracking-tight mb-2 px-2"><div class="flex items-center gap-3 text-xl font-bold"><svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 24 24" height="25" width="25" xmlns="http://www.w3.org/2000/svg"><path d="M2 8C2 7.44772 2.44772 7 3 7H21C21.5523 7 22 7.44772 22 8C22 8.55228 21.5523 9 21 9H3C2.44772 9 2 8.55228 2 8Z" fill="currentColor"></path><path d="M2 12C2 11.4477 2.44772 11 3 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H3C2.44772 13 2 12.5523 2 12Z" fill="currentColor"></path><path d="M3 15C2.44772 15 2 15.4477 2 16C2 16.5523 2.44772 17 3 17H15C15.5523 17 16 16.5523 16 16C16 15.4477 15.5523 15 15 15H3Z" fill="currentColor"></path></svg><span>Table of Contents</span></div></h2><ul class="px-2"><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/blog-scroll-spy#3b17e50965624bc1a34bebfb0253b731"><div class="flex items-center gap-1 text-base"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>TOC(Table of contents)</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/blog-scroll-spy#aed5012a26a346e197761ca64c703db8"><div class="flex items-center gap-1 text-base"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>스크롤 스파이</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/blog-scroll-spy#845a2c9c9a9041aba263f065e49b24ac"><div class="flex items-center gap-1 ml-8 text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>Intersection Observer 활용</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/blog-scroll-spy#93705485f6034db690d4de7c99f21693"><div class="flex items-center gap-1 ml-16 text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>구현 코드</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/blog-scroll-spy#4c6f88e49b154b7aa2ba32043b3ddd05"><div class="flex items-center gap-1 ml-16 text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>문제점</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/blog-scroll-spy#c7dc16bc69cd4bdca5d6dba1eea7d72c"><div class="flex items-center gap-1 ml-8 text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>h 태그의 위치를 구하고 계산하여 활용</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/blog-scroll-spy#d3ac7588ee1e4531a47b5e6eb87e2e64"><div class="flex items-center gap-1 ml-16 text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>구현 코드</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/blog-scroll-spy#b111b199fdb740d8ae7146187b0c1df4"><div class="flex items-center gap-1 ml-16 text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>문제점</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/blog-scroll-spy#2dade119a1ea4891af5e2b063463879e"><div class="flex items-center gap-1 text-base"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>마치며</span></div></a></li></ul></section><main class="notion dark-mode notion-page notion-block-2f519016075247a6914208cb1d04bd10"><div class="notion-viewport"></div><div class="notion-collection-page-properties"><div class="notion-collection-row"><div class="notion-collection-row-body"></div></div></div><div class="notion-text notion-block-d1a7a1b295444c7c85ff0a8fbb4233cd">개인 블로그를 구현하고 내용을 확인하는 과정에서 어느 부분을 읽고 있는지 한눈에 볼 수 있는 기능을 구현하면 좋겠다는 생각을 가지게 되었습니다. 이미 <code class="notion-inline-code">react-notion-x</code>에서 제공하는 기능인 Table of contents를 그대로 사용할 수 있었지만 모바일 환경에서는 아예 TOC를 보여주지 않는다는 점과 좀 더 이쁘게 커스터마이징하기 위해 직접 구현해 보기로 결정했습니다. Intersection observer를 활용하는 방법과 각 h 태그의 위치를 구하는 방법을 모두 활용해 보며 장단점을 찾게 되어 이에 대해 공유하고자 합니다.</div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-3b17e50965624bc1a34bebfb0253b731" data-id="3b17e50965624bc1a34bebfb0253b731"><span><div id="3b17e50965624bc1a34bebfb0253b731" class="notion-header-anchor"></div><a class="notion-hash-link" href="#3b17e50965624bc1a34bebfb0253b731" title="TOC(Table of contents)"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">TOC(Table of contents)</span></span></h2><div class="notion-text notion-block-4072070c07a94adb96df2826e509c405">스크롤 스파이 기능을 바로 구현하고 싶었지만 표시할 곳이 없기에 침착하고 우선 목차를 추출하고 표시하는 것을 구현했습니다. </div><div class="notion-text notion-block-fe8f79ded5c94db7bec510324cf12121">활용하고 있던 <code class="notion-inline-code">react-notion-x</code>내에 포함된 <code class="notion-inline-code">notion-utils</code>에 <a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://github.com/NotionX/react-notion-x/blob/master/packages/notion-utils/src/get-page-table-of-contents.ts">getPageTableOfContents</a>를 참고해서 타입 불일치 문제와 불필요한 인자를 제거하고 구현했습니다.</div><div class="notion-text notion-block-77214477f1cb47f5b652b21826bba851">노션 API로 받은 내용을 확인해 보면 header를 하나의 블록으로 처리하기에 어렵지 않게 구현할 수 있었으나 빈 header도 목차에 추가된다는 점을 개선하기 위해 렌더링 과정에서 조건문을 추가했습니다. 모바일 환경에서도 포스트 상단에서 목차를 통해 각 내용으로 접근이 가능하도록 했습니다.</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-0ca99497a2194f5499d321b7ccbf4deb"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:240px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F7b0c1ebf-29f7-4bde-9810-55e79a3d582e%2Ff0d4c03c-7a27-4cb1-9b48-3cfcd4c2c145%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-11-20_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_8.57.20.png?table=block&amp;id=0ca99497-a219-4f54-99d3-21b7ccbf4deb&amp;cache=v2" alt="결과물" loading="lazy" decoding="async"/><figcaption class="notion-asset-caption">결과물</figcaption></div></figure><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-aed5012a26a346e197761ca64c703db8" data-id="aed5012a26a346e197761ca64c703db8"><span><div id="aed5012a26a346e197761ca64c703db8" class="notion-header-anchor"></div><a class="notion-hash-link" href="#aed5012a26a346e197761ca64c703db8" title="스크롤 스파이"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">스크롤 스파이</span></span></h2><div class="notion-text notion-block-01d34b9f81fe4c73a3ddde268c3dde78">목차를 마음에 들게 표시할 수 있다면 이제 읽고 있는 위치에 맞게 내용을 활성화해주면 됩니다. <code class="notion-inline-code">activeId</code> 상태를 등록하고 이를 통해 관리하는 방법을 택했지만 어떻게 이 상태를 변경할지에 대해 고민하는 시간을 가졌습니다.</div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-845a2c9c9a9041aba263f065e49b24ac" data-id="845a2c9c9a9041aba263f065e49b24ac"><span><div id="845a2c9c9a9041aba263f065e49b24ac" class="notion-header-anchor"></div><a class="notion-hash-link" href="#845a2c9c9a9041aba263f065e49b24ac" title="Intersection Observer 활용"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Intersection Observer 활용</span></span></h3><div class="notion-text notion-block-4784fdaa430543cc9bd7532ee9aae461">사실 엘리먼트의 스크롤 위치를 구하는 방법을 먼저 떠올렸지만 약간의 망설임이 있었습니다. scroll 이벤트 같은 경우에는 매 움직임마다 리스너가 동작하기 때문에 성능상 문제가 발생할 수 있었기 때문입니다. </div><div class="notion-text notion-block-2b611b7cb98143b6a51425ee7dfd9b10">디바운싱과 같은 최적화를 적용할 수 있지만 근본적으로 h 태그가 화면 특정 부분이 표시되면 그때 이벤트를 발생시키는 Intersection observer 방식으로 이러한 단점을 해결할 수 있을 거라고 생각했습니다.</div><h4 class="notion-h notion-h3 notion-h-indent-2 notion-block-93705485f6034db690d4de7c99f21693" data-id="93705485f6034db690d4de7c99f21693"><span><div id="93705485f6034db690d4de7c99f21693" class="notion-header-anchor"></div><a class="notion-hash-link" href="#93705485f6034db690d4de7c99f21693" title="구현 코드"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">구현 코드</span></span></h4><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">import { Dispatch, SetStateAction, useEffect, useState } from &quot;react&quot;;

const observerOption = {
  threshold: 0.4,
  rootMargin: &quot;-70px 0px -90% 0px&quot;,
};

const getIntersectionObserver = (
  setState: Dispatch&lt;SetStateAction&lt;string&gt;&gt;,
) =&gt; {
  const observer = new IntersectionObserver(entries =&gt; {
    entries.forEach(entry =&gt; {
      if (entry.isIntersecting) {
        const target = entry.target as HTMLElement;
        if (target.dataset.id) {
          setState(target.dataset.id);
        }
      }
    });
  }, observerOption);

  return observer;
};

const useScrollSpy = () =&gt; {
  const [activeId, setActiveId] = useState(&quot;&quot;);

  useEffect(() =&gt; {
    const observer = getIntersectionObserver(setActiveId);
    const headingElements = Array.from(document.querySelectorAll(&quot;.notion-h&quot;));
    headingElements.map(header =&gt; {
      observer.observe(header);
    });

    return () =&gt; {
      observer.disconnect();
    };
  }, []);

  return activeId;
};

export default useScrollSpy;</code></pre><div class="notion-text notion-block-748a1dc4a265427b990f576b8ca3c3c3">UI와 로직을 분리해서 구현하고자 해서 커스텀 훅으로 로직을 구현했습니다.  </div><div class="notion-text notion-block-6bc4c7b757cc42bcbac55f0cab2a00be">DOM이 그려진 이후 동작해야 하기에 <code class="notion-inline-code">useEffect</code> 내부에 옵저버를 등록하는 로직을 작성했습니다. 노션 페이지를 렌더링하는 곳에서 <code class="notion-inline-code">notion-h</code>라는  class로 구분하고 있어 해당 엘리먼트들을 배열로 만드는 작업도 거쳤습니다. 페이지가 언마운트 될 때에는 등록된 옵저버들을 모두 해제하는 <code class="notion-inline-code">disconnect</code>를 활용해서 Clean up했습니다.</div><h4 class="notion-h notion-h3 notion-h-indent-2 notion-block-4c6f88e49b154b7aa2ba32043b3ddd05" data-id="4c6f88e49b154b7aa2ba32043b3ddd05"><span><div id="4c6f88e49b154b7aa2ba32043b3ddd05" class="notion-header-anchor"></div><a class="notion-hash-link" href="#4c6f88e49b154b7aa2ba32043b3ddd05" title="문제점"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">문제점</span></span></h4><div class="notion-text notion-block-e3c12b9bfc4f460b8f42a5fc79dd42d3">뷰포트를 기준으로 <code class="notion-inline-code">rootMargin</code>을 설정하는 일도 까다로웠지만 스크롤이 아래로 내려갈 때에는 문제없이 동작했습니다.</div><div class="notion-text notion-block-3d1f259b53eb4b3f8310f9f8e6b3a359">문제가 발생했던 부분은 스크롤을 빠르게 위로 올릴 때였습니다.  스크롤은 최상단으로 갔지만 <code class="notion-inline-code">activeId</code>는 중간 어디쯤에 멈춰있는 현상을 확인했습니다. intersection observer 방법을 사용하는 다른 블로그들에서도 같은 문제를 확인할 수 있었습니다.</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-8166245c5fec476e8b375dc7287a01fc"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:528px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F7b0c1ebf-29f7-4bde-9810-55e79a3d582e%2Fd031988d-349f-4995-87fb-33377f19ea1a%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-11-21_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.26.17.png?table=block&amp;id=8166245c-5fec-476e-8b37-5dc7287a01fc&amp;cache=v2" alt="rootMargin" loading="lazy" decoding="async"/><figcaption class="notion-asset-caption">rootMargin</figcaption></div></figure><div class="notion-text notion-block-a680e6ac4cca4e8db9f1024b9529c89f">h 태그처럼 비교적 작은 크기를 가지는 대상을 비동기적으로 감시할 수 있지만 작은 <code class="notion-inline-code">rootMargin</code>으로 인해 쓰로틀링이 적용된 것과 같이 동작하는 것이 원인이었습니다. </div><div class="notion-text notion-block-06b1da6fa5d644d5bf2d554dabe6b103">정확한 내부 로직이나 최적화를 확인할 수 없어 아쉬움이 남지만 한 viewport 안에 여러 개의 h 태그가 존재할 수 있는 블로그 글 특성상 한계를 느껴 다음 방법을 진행하게 되었습니다.</div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-c7dc16bc69cd4bdca5d6dba1eea7d72c" data-id="c7dc16bc69cd4bdca5d6dba1eea7d72c"><span><div id="c7dc16bc69cd4bdca5d6dba1eea7d72c" class="notion-header-anchor"></div><a class="notion-hash-link" href="#c7dc16bc69cd4bdca5d6dba1eea7d72c" title="h 태그의 위치를 구하고 계산하여 활용"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">h 태그의 위치를 구하고 계산하여 활용</span></span></h3><div class="notion-text notion-block-8ecda61174bc4825aa18a92f776cd588">저는 이미 scrollY 값을 활용하는 스크롤 진행 바를 구현했습니다. <code class="notion-inline-code">framer-motion</code>에서 제공하는 <code class="notion-inline-code">useScroll</code>의 내부 로직을 확인해 보니 스크롤 이벤트 등록과 clean up 함수 또한 잘 설정되어 있어 또 같은 내용을 구현하기보다 이를 활용하였습니다.</div><div class="notion-text notion-block-404851087c8c42cb9a49c8af90dbad4f">이전에는 notion-h를 class로 가진 엘리먼트 그 자체를 배열로 만들었다면 이번에는 id, 위치를 객체로 만들어 ref에 배열로 담았습니다.</div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">const hElementPositions = useRef&lt;hElementPositionRefType[]&gt;();
...
const getHTagPositions = () =&gt; {
		const pageTop = 201; //default page top
	  hElementPositions.current = Array.from(
      document.querySelectorAll&lt;HTMLElement&gt;(&quot;.notion-h&quot;),
    )
      .filter(header =&gt; header.querySelector(&quot;.notion-h-title&quot;)?.textContent)
      .map(header =&gt; ({
        id: header.dataset.id as string,
        top: header.offsetTop + pageTop,
      }));
};</code></pre><h4 class="notion-h notion-h3 notion-h-indent-2 notion-block-d3ac7588ee1e4531a47b5e6eb87e2e64" data-id="d3ac7588ee1e4531a47b5e6eb87e2e64"><span><div id="d3ac7588ee1e4531a47b5e6eb87e2e64" class="notion-header-anchor"></div><a class="notion-hash-link" href="#d3ac7588ee1e4531a47b5e6eb87e2e64" title="구현 코드"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">구현 코드</span></span></h4><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">import { useMotionValueEvent, useScroll } from &quot;framer-motion&quot;;
import { useRef, useState } from &quot;react&quot;;

interface hElementPositionRefType {
  id: string;
  top: number;
}

const useScrollSpy = () =&gt; {
  const hElementPositions = useRef&lt;hElementPositionRefType[]&gt;();
  const [activeId, setActiveId] = useState(&quot;&quot;);
  const { scrollY } = useScroll();

  const getHTagPositions = () =&gt; {
    ...
  };

  useMotionValueEvent(scrollY, &quot;change&quot;, latest =&gt; {
    getHTagPositions();
    let headingId = &quot;&quot;;
    if (hElementPositions.current) {
      for (let i = 0; i &lt; hElementPositions.current.length; i++) {
        if (latest &gt;= hElementPositions.current[i].top) {
          headingId = hElementPositions.current[i].id;
          continue;
        }
        break;
      }
			setActiveId(headingId);
    }
  });

  return activeId;
};

export default useScrollSpy;</code></pre><div class="notion-text notion-block-6b06572760e94449946a19ccd9c9f866">이벤트가 발생하면 배열을 순회하며 현재 scrollY(latest)가 엘리먼트의 위치보다 크거나 같은 경우 <code class="notion-inline-code">headingId</code>를 바꾸고 작다면 for문을 빠져나와 상태를 변경하도록 구현했습니다.</div><h4 class="notion-h notion-h3 notion-h-indent-2 notion-block-b111b199fdb740d8ae7146187b0c1df4" data-id="b111b199fdb740d8ae7146187b0c1df4"><span><div id="b111b199fdb740d8ae7146187b0c1df4" class="notion-header-anchor"></div><a class="notion-hash-link" href="#b111b199fdb740d8ae7146187b0c1df4" title="문제점"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">문제점</span></span></h4><div class="notion-text notion-block-7a1df1d552f04ea0821f2670758e3d77"><code class="notion-inline-code">useMotionValueEvent</code> 내부에 <code class="notion-inline-code">getHTagPositions</code> 함수가 이벤트마다 다시 계산되는 것을 확인할 수 있습니다. 이유는 블로그를 직접 만들며 <code class="notion-inline-code">react-notion-x</code>의 이미지 렌더링에서 문제가 발생했는데요. content layout shift가 일어난다는 점입니다. 스켈레톤과 같은 최적화 기법으로 이를 해결할 수 있지만 라이브러리의 특성상 커스터마이징에 어려움을 겪어 스크롤이 일어날 때 위치를 다시 구해서 이를 해결하고자 했습니다.</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-3c559b74c9ba44229b9df7d9d9101a9f"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:293px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F7b0c1ebf-29f7-4bde-9810-55e79a3d582e%2F8c9d15bc-22a1-443c-a677-478d941df38e%2F%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-18_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_2.50.44.png?table=block&amp;id=3c559b74-c9ba-4422-9b9d-f7d9d9101a9f&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-9a14e698feef4e5da870227c5a854cbb">시간을 측정해 본 결과 정상적인 범위 안에서 계산이 일어나는 경우 충분히 빠르다는 점을 확인하고 이런 방법을 채택했습니다.</div><div class="notion-text notion-block-33bbb80c639a43bdb156d6c93b362277">결과적으로 이런 과정을 거치며 스스로도 만족할 수 있는 스크롤 스파이 기능을 구현할 수 있었습니다.</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-9cc5826dc8934ab4ab733b917d97d86f"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:240px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F7b0c1ebf-29f7-4bde-9810-55e79a3d582e%2Faa5cf378-4b9f-41ae-835b-9d11493cfa52%2FNov-21-2023_17-17-00.gif?table=block&amp;id=9cc5826d-c893-4ab4-ab73-3b917d97d86f&amp;cache=v2" alt="요란한 확인" loading="lazy" decoding="async"/><figcaption class="notion-asset-caption">요란한 확인</figcaption></div></figure><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-2dade119a1ea4891af5e2b063463879e" data-id="2dade119a1ea4891af5e2b063463879e"><span><div id="2dade119a1ea4891af5e2b063463879e" class="notion-header-anchor"></div><a class="notion-hash-link" href="#2dade119a1ea4891af5e2b063463879e" title="마치며"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">마치며</span></span></h2><div class="notion-text notion-block-a571b4932edc4f04a7d9e8d42d962bc8">블로그를 직접 구현하며 모든 기능들에 관심을 가지고 만들었지만 특히 기억에 남는 내용을 작성해보았습니다. 간단할 수 있는 스크롤 스파이를 구현이지만 제가 겪었던 문제점들과 삽질을 누군가 경험하기 전에 확인한다면 시간을 아낄 수 있지 않을까 생각합니다. 그리고 다시 한번 느꼈지만 각 방법에는 장단점이 존재하고 어떤 선택을 하는지는 개발자의 판단이라는 부분에서 개발의 즐거움을 또 한번 느끼게 되었습니다.</div><div class="notion-text notion-block-ced34dd7dd904cc1a5f7db47546e05cc">목표로 하는 일이 잘 안풀리기도 하지만 끈기를 가지고 또 원인을 찾는 즐거움을 잊지 않는 개발자가 되어야 겠습니다.</div></main><hr class="border-neutral-300 dark:border-neutral-500 border-1 w-full my-6"/><section class="mb-12 flex justify-between px-2"><div></div><div><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/module-cjs-esm"><div class="flex items-center gap-1 text-xs justify-end"><span>Next</span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"></path><path d="M16.172 11l-5.364-5.364 1.414-1.414L20 12l-7.778 7.778-1.414-1.414L16.172 13H4v-2z"></path></g></svg></div><span class="tracking-tighter">JS module 그리고 CJS와 ESM의 차이</span></a></div></section><section></section></article><hr class="border-neutral-300 dark:border-neutral-500 border-1 w-full my-8"/><footer class="mb-10 flex flex-col items-end text-sm"><div class="mx-auto mb-2 flex gap-2 text-xl sm:mx-0"><a target="_blank" href="mailto:minjae7728@gmail.com" rel="noreferrer" aria-label="check author&#x27;s email" class="text-tertiary hover:text-primary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M24 4.5v15c0 .85-.65 1.5-1.5 1.5H21V7.387l-9 6.463-9-6.463V21H1.5C.649 21 0 20.35 0 19.5v-15c0-.425.162-.8.431-1.068C.7 3.16 1.076 3 1.5 3H2l10 7.25L22 3h.5c.425 0 .8.162 1.069.432.27.268.431.643.431 1.068z"></path></svg></a><a target="_blank" href="https://github.com/mxx-kor" rel="noreferrer" aria-label="check author&#x27;s github" class="text-tertiary hover:text-primary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a target="_blank" href="https://www.linkedin.com/in/%EB%AF%BC%EC%9E%AC-%EA%B9%80-35a409204/" rel="noreferrer" aria-label="check author&#x27;s linkedin" class="text-tertiary hover:text-primary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a></div><p class="text-tertiary mx-auto sm:mx-0"><span>© </span><a class="hover:text-primary hover:underline" href="/about">Minjae Kim</a><span> Powered by </span><a target="_blank" href="https://nextjs.org/" rel="noreferrer" class="hover:text-primary hover:underline">Next.js</a><span>, </span><a target="_blank" href="https://pages.github.com/" rel="noreferrer" class="hover:text-primary hover:underline">Github Pages</a><span>, </span><a target="_blank" href="https://developers.notion.com/" rel="noreferrer" class="hover:text-primary hover:underline">Notion API</a></p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"prevPost":null,"post":{"object":"page","id":"2f519016-0752-47a6-9142-08cb1d04bd10","created_time":"2023-11-20T11:04:00.000Z","last_edited_time":"2023-11-21T08:33:00.000Z","created_by":{"object":"user","id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6"},"last_edited_by":{"object":"user","id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6"},"cover":null,"icon":null,"parent":{"type":"database_id","database_id":"f49dbc55-2ac0-4786-b9e3-4b9522a6a294"},"archived":false,"properties":{"Main":{"id":"H%60Il","type":"checkbox","checkbox":true},"Summary":{"id":"LkE%3E","type":"rich_text","rich_text":[{"type":"text","text":{"content":"Intersection observer 방식과 계산된 scrollY를 활용하는 방법 모두 확인해보자.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Intersection observer 방식과 계산된 scrollY를 활용하는 방법 모두 확인해보자.","href":null}]},"Tags":{"id":"Q%5B~X","type":"multi_select","multi_select":[{"id":"7982bf8b-df3e-4377-b1b9-84dc37c9ec2b","name":"개인 프로젝트","color":"default"},{"id":"dcc8bb71-28e8-4ef7-8f0b-1922c0daf129","name":"React","color":"brown"}]},"Title":{"id":"%5BeXF","type":"rich_text","rich_text":[{"type":"text","text":{"content":"블로그 스크롤 스파이(TOC) 구현기","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"블로그 스크롤 스파이(TOC) 구현기","href":null}]},"Slug":{"id":"title","type":"title","title":[{"type":"text","text":{"content":"blog-scroll-spy","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"blog-scroll-spy","href":null}]}},"url":"https://www.notion.so/blog-scroll-spy-2f519016075247a6914208cb1d04bd10","public_url":"https://longhaired-way-a70.notion.site/blog-scroll-spy-2f519016075247a6914208cb1d04bd10","request_id":"f5d2c29d-1feb-43aa-b2d2-1b9914ac51dd"},"nextPost":{"object":"page","id":"6da47cc3-3384-4d52-8b34-e0cf97e5caf9","created_time":"2023-10-26T07:22:00.000Z","last_edited_time":"2023-10-30T09:14:00.000Z","created_by":{"object":"user","id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6"},"last_edited_by":{"object":"user","id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6"},"cover":null,"icon":null,"parent":{"type":"database_id","database_id":"f49dbc55-2ac0-4786-b9e3-4b9522a6a294"},"archived":false,"properties":{"Main":{"id":"H%60Il","type":"checkbox","checkbox":true},"Summary":{"id":"LkE%3E","type":"rich_text","rich_text":[{"type":"text","text":{"content":"require, import 뭐가 다른지, 여러 오류를 통해 함께 살펴보자.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"require, import 뭐가 다른지, 여러 오류를 통해 함께 살펴보자.","href":null}]},"Tags":{"id":"Q%5B~X","type":"multi_select","multi_select":[{"id":"69e1ad87-e25d-44b0-865a-be86ed1589c4","name":"JavaScript","color":"blue"},{"id":"2bcdc16c-6690-496f-944a-f21d1db899b6","name":"module","color":"blue"}]},"Title":{"id":"%5BeXF","type":"rich_text","rich_text":[{"type":"text","text":{"content":"JS module 그리고 CJS와 ESM의 차이","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"JS module 그리고 CJS와 ESM의 차이","href":null}]},"Slug":{"id":"title","type":"title","title":[{"type":"text","text":{"content":"module-cjs-esm","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"module-cjs-esm","href":null}]}},"url":"https://www.notion.so/module-cjs-esm-6da47cc333844d528b34e0cf97e5caf9","public_url":"https://longhaired-way-a70.notion.site/module-cjs-esm-6da47cc333844d528b34e0cf97e5caf9"},"recordMap":{"block":{"2f519016-0752-47a6-9142-08cb1d04bd10":{"value":{"id":"2f519016-0752-47a6-9142-08cb1d04bd10","version":1232,"type":"page","properties":{"H`Il":[["Yes"]],"LkE\u003e":[["Intersection observer 방식과 계산된 scrollY를 활용하는 방법 모두 확인해보자."]],"Q[~X":[["개인 프로젝트,React"]],"[eXF":[["블로그 스크롤 스파이(TOC) 구현기"]],"title":[["blog-scroll-spy"]]},"content":["d1a7a1b2-9544-4c7c-85ff-0a8fbb4233cd","3b17e509-6562-4bc1-a34b-ebfb0253b731","4072070c-07a9-4adb-96df-2826e509c405","fe8f79de-d5c9-4db7-bec5-10324cf12121","77214477-f1cb-47f5-b652-b21826bba851","0ca99497-a219-4f54-99d3-21b7ccbf4deb","aed5012a-26a3-46e1-9776-1ca64c703db8","01d34b9f-81fe-4c73-a3dd-de268c3dde78","845a2c9c-9a90-41ab-a263-f065e49b24ac","4784fdaa-4305-43cc-9bd7-532ee9aae461","2b611b7c-b981-43b6-a514-25ee7dfd9b10","93705485-f603-4db6-90d4-de7c99f21693","c8fdbbd2-dcf3-4b09-baf8-b8b1da4d8080","748a1dc4-a265-427b-990f-576b8ca3c3c3","6bc4c7b7-57cc-42bc-bac5-5f0cab2a00be","4c6f88e4-9b15-4b7a-a2ba-32043b3ddd05","e3c12b9b-fc4f-460b-8f42-a5fc79dd42d3","3d1f259b-53eb-4b3f-8310-f9f8e6b3a359","8166245c-5fec-476e-8b37-5dc7287a01fc","a680e6ac-4cca-4e8d-b9f1-024b9529c89f","06b1da6f-a5d6-44d5-bf2d-554dabe6b103","c7dc16bc-69cd-4bdc-a5d6-dba1eea7d72c","8ecda611-74bc-4825-aa18-a92f776cd588","40485108-7c8c-42cb-9a49-c8af90dbad4f","4e2cde4d-3609-4ee2-8497-45ed5375f7a4","d3ac7588-ee1e-4531-a47b-5e6eb87e2e64","d5f729d7-7b8b-46bf-8587-2dd220420b7c","6b065727-60e9-4449-946a-19ccd9c9f866","b111b199-fdb7-40d8-ae71-46187b0c1df4","7a1df1d5-52f0-4ea0-821f-2670758e3d77","3c559b74-c9ba-4422-9b9d-f7d9d9101a9f","9a14e698-feef-4e5d-a870-227c5a854cbb","33bbb80c-639a-43bd-b156-d6c93b362277","9cc5826d-c893-4ab4-ab73-3b917d97d86f","2dade119-a1ea-4891-af5e-2b063463879e","a571b493-2edc-4f04-a7d9-e8d42d962bc8","ced34dd7-dd90-4cc1-a5f7-db47546e05cc"],"created_time":1700478294950,"last_edited_time":1700555587709,"parent_id":"77251464-f92c-498c-8ec6-b1ee5950601b","parent_table":"collection","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"f49dbc55-2ac0-4786-b9e3-4b9522a6a294":{"value":{"id":"f49dbc55-2ac0-4786-b9e3-4b9522a6a294","version":109,"type":"collection_view","view_ids":["2943edd6-04c4-497c-9810-5b340d73025b"],"collection_id":"77251464-f92c-498c-8ec6-b1ee5950601b","format":{"collection_pointer":{"id":"77251464-f92c-498c-8ec6-b1ee5950601b","table":"collection","spaceId":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"}},"permissions":[{"role":"editor","type":"user_permission","user_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6"},{"role":"reader","type":"public_permission","added_timestamp":1688473010972,"allow_duplicate":false},{"type":"restricted_permission"},{"role":{"read_content":true},"type":"bot_permission","bot_id":"95ebcfc3-c78e-4f51-8a1d-715c5aee0b0b","parent_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e","parent_table":"space"}],"created_time":1688471518135,"last_edited_time":1700478894985,"parent_id":"6da363e3-8c9b-4c93-a407-b2dfdda51a20","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"d1a7a1b2-9544-4c7c-85ff-0a8fbb4233cd":{"value":{"id":"d1a7a1b2-9544-4c7c-85ff-0a8fbb4233cd","version":4353,"type":"text","properties":{"title":[["개인 블로그를 구현하고 내용을 확인하는 과정에서 어느 부분을 읽고 있는지 한눈에 볼 수 있는 기능을 구현하면 좋겠다는 생각을 가지게 되었습니다. 이미 "],["react-notion-x",[["c"]]],["에서 제공하는 기능인 Table of contents를 그대로 사용할 수 있었지만 모바일 환경에서는 아예 TOC를 보여주지 않는다는 점과 좀 더 이쁘게 커스터마이징하기 위해 직접 구현해 보기로 결정했습니다. Intersection observer를 활용하는 방법과 각 h 태그의 위치를 구하는 방법을 모두 활용해 보며 장단점을 찾게 되어 이에 대해 공유하고자 합니다."]]},"created_time":1700478952369,"last_edited_time":1700555178568,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"3b17e509-6562-4bc1-a34b-ebfb0253b731":{"value":{"id":"3b17e509-6562-4bc1-a34b-ebfb0253b731","version":34,"type":"header","properties":{"title":[["TOC(Table of contents)"]]},"created_time":1700479914727,"last_edited_time":1700480743168,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"4072070c-07a9-4adb-96df-2826e509c405":{"value":{"id":"4072070c-07a9-4adb-96df-2826e509c405","version":4163,"type":"text","properties":{"title":[["스크롤 스파이 기능을 바로 구현하고 싶었지만 표시할 곳이 없기에 침착하고 우선 목차를 추출하고 표시하는 것을 구현했습니다. "]]},"created_time":1700479995412,"last_edited_time":1700481980147,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"fe8f79de-d5c9-4db7-bec5-10324cf12121":{"value":{"id":"fe8f79de-d5c9-4db7-bec5-10324cf12121","version":284,"type":"text","properties":{"title":[["활용하고 있던 "],["react-notion-x",[["c"]]],["내에 포함된 "],["notion-utils",[["c"]]],["에 "],["getPageTableOfContents",[["a","https://github.com/NotionX/react-notion-x/blob/master/packages/notion-utils/src/get-page-table-of-contents.ts"]]],["를 참고해서 타입 불일치 문제와 불필요한 인자를 제거하고 구현했습니다."]]},"created_time":1700481207097,"last_edited_time":1700481832469,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"77214477-f1cb-47f5-b652-b21826bba851":{"value":{"id":"77214477-f1cb-47f5-b652-b21826bba851","version":616,"type":"text","properties":{"title":[["노션 API로 받은 내용을 확인해 보면 header를 하나의 블록으로 처리하기에 어렵지 않게 구현할 수 있었으나 빈 header도 목차에 추가된다는 점을 개선하기 위해 렌더링 과정에서 조건문을 추가했습니다. 모바일 환경에서도 포스트 상단에서 목차를 통해 각 내용으로 접근이 가능하도록 했습니다."]]},"created_time":1700481211883,"last_edited_time":1700555198483,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"0ca99497-a219-4f54-99d3-21b7ccbf4deb":{"value":{"id":"0ca99497-a219-4f54-99d3-21b7ccbf4deb","version":49,"type":"image","properties":{"size":[["122.7KB"]],"title":[["스크린샷 2023-11-20 오후 8.57.20.png"]],"source":[["https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/f0d4c03c-7a27-4cb1-9b48-3cfcd4c2c145/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-11-20_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_8.57.20.png"]],"caption":[["결과물"]]},"format":{"block_width":240,"block_height":320,"display_source":"https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/f0d4c03c-7a27-4cb1-9b48-3cfcd4c2c145/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-11-20_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_8.57.20.png","block_full_width":false,"block_page_width":false,"block_aspect_ratio":1.1137931034482758,"block_preserve_scale":true},"created_time":1700481444886,"last_edited_time":1700549598914,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"file_ids":["f0d4c03c-7a27-4cb1-9b48-3cfcd4c2c145"],"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"aed5012a-26a3-46e1-9776-1ca64c703db8":{"value":{"id":"aed5012a-26a3-46e1-9776-1ca64c703db8","version":347,"type":"header","properties":{"title":[["스크롤 스파이"]]},"created_time":1700479665124,"last_edited_time":1700481584341,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"01d34b9f-81fe-4c73-a3dd-de268c3dde78":{"value":{"id":"01d34b9f-81fe-4c73-a3dd-de268c3dde78","version":2617,"type":"text","properties":{"title":[["목차를 마음에 들게 표시할 수 있다면 이제 읽고 있는 위치에 맞게 내용을 활성화해주면 됩니다. "],["activeId",[["c"]]],[" 상태를 등록하고 이를 통해 관리하는 방법을 택했지만 어떻게 이 상태를 변경할지에 대해 고민하는 시간을 가졌습니다."]]},"created_time":1700481586803,"last_edited_time":1700555216050,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"845a2c9c-9a90-41ab-a263-f065e49b24ac":{"value":{"id":"845a2c9c-9a90-41ab-a263-f065e49b24ac","version":1128,"type":"sub_header","properties":{"title":[["Intersection Observer 활용"]]},"created_time":1700482721624,"last_edited_time":1700483015100,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"4784fdaa-4305-43cc-9bd7-532ee9aae461":{"value":{"id":"4784fdaa-4305-43cc-9bd7-532ee9aae461","version":1452,"type":"text","properties":{"title":[["사실 엘리먼트의 스크롤 위치를 구하는 방법을 먼저 떠올렸지만 약간의 망설임이 있었습니다. scroll 이벤트 같은 경우에는 매 움직임마다 리스너가 동작하기 때문에 성능상 문제가 발생할 수 있었기 때문입니다. "]]},"created_time":1700549639163,"last_edited_time":1700549800055,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"2b611b7c-b981-43b6-a514-25ee7dfd9b10":{"value":{"id":"2b611b7c-b981-43b6-a514-25ee7dfd9b10","version":995,"type":"text","properties":{"title":[["디바운싱과 같은 최적화를 적용할 수 있지만 근본적으로 h 태그가 화면 특정 부분이 표시되면 그때 이벤트를 발생시키는 Intersection observer 방식으로 이러한 단점을 해결할 수 있을 거라고 생각했습니다."]]},"created_time":1700549800052,"last_edited_time":1700555229228,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"93705485-f603-4db6-90d4-de7c99f21693":{"value":{"id":"93705485-f603-4db6-90d4-de7c99f21693","version":46,"type":"sub_sub_header","properties":{"title":[["구현 코드"]]},"created_time":1700550359462,"last_edited_time":1700550362407,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"c8fdbbd2-dcf3-4b09-baf8-b8b1da4d8080":{"value":{"id":"c8fdbbd2-dcf3-4b09-baf8-b8b1da4d8080","version":7,"type":"code","properties":{"title":[["import { Dispatch, SetStateAction, useEffect, useState } from \"react\";\n\nconst observerOption = {\n  threshold: 0.4,\n  rootMargin: \"-70px 0px -90% 0px\",\n};\n\nconst getIntersectionObserver = (\n  setState: Dispatch\u003cSetStateAction\u003cstring\u003e\u003e,\n) =\u003e {\n  const observer = new IntersectionObserver(entries =\u003e {\n    entries.forEach(entry =\u003e {\n      if (entry.isIntersecting) {\n        const target = entry.target as HTMLElement;\n        if (target.dataset.id) {\n          setState(target.dataset.id);\n        }\n      }\n    });\n  }, observerOption);\n\n  return observer;\n};\n\nconst useScrollSpy = () =\u003e {\n  const [activeId, setActiveId] = useState(\"\");\n\n  useEffect(() =\u003e {\n    const observer = getIntersectionObserver(setActiveId);\n    const headingElements = Array.from(document.querySelectorAll(\".notion-h\"));\n    headingElements.map(header =\u003e {\n      observer.observe(header);\n    });\n\n    return () =\u003e {\n      observer.disconnect();\n    };\n  }, []);\n\n  return activeId;\n};\n\nexport default useScrollSpy;"]],"language":[["JavaScript"]]},"created_time":1700550245205,"last_edited_time":1700550245796,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"748a1dc4-a265-427b-990f-576b8ca3c3c3":{"value":{"id":"748a1dc4-a265-427b-990f-576b8ca3c3c3","version":1171,"type":"text","properties":{"title":[["UI와 로직을 분리해서 구현하고자 해서 커스텀 훅으로 로직을 구현했습니다.  "]]},"created_time":1700549904775,"last_edited_time":1700555248056,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"6bc4c7b7-57cc-42bc-bac5-5f0cab2a00be":{"value":{"id":"6bc4c7b7-57cc-42bc-bac5-5f0cab2a00be","version":1092,"type":"text","properties":{"title":[["DOM이 그려진 이후 동작해야 하기에 "],["useEffect",[["c"]]],[" 내부에 옵저버를 등록하는 로직을 작성했습니다. 노션 페이지를 렌더링하는 곳에서 "],["notion-h",[["c"]]],["라는  class로 구분하고 있어 해당 엘리먼트들을 배열로 만드는 작업도 거쳤습니다. 페이지가 언마운트 될 때에는 등록된 옵저버들을 모두 해제하는 "],["disconnect",[["c"]]],["를 활용해서 Clean up했습니다."]]},"created_time":1700550629854,"last_edited_time":1700555260668,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"4c6f88e4-9b15-4b7a-a2ba-32043b3ddd05":{"value":{"id":"4c6f88e4-9b15-4b7a-a2ba-32043b3ddd05","version":42,"type":"sub_sub_header","properties":{"title":[["문제점"]]},"created_time":1700550844674,"last_edited_time":1700550848749,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"e3c12b9b-fc4f-460b-8f42-a5fc79dd42d3":{"value":{"id":"e3c12b9b-fc4f-460b-8f42-a5fc79dd42d3","version":417,"type":"text","properties":{"title":[["뷰포트를 기준으로 "],["rootMargin",[["c"]]],["을 설정하는 일도 까다로웠지만 스크롤이 아래로 내려갈 때에는 문제없이 동작했습니다."]]},"created_time":1700550849375,"last_edited_time":1700551247188,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"3d1f259b-53eb-4b3f-8310-f9f8e6b3a359":{"value":{"id":"3d1f259b-53eb-4b3f-8310-f9f8e6b3a359","version":1334,"type":"text","properties":{"title":[["문제가 발생했던 부분은 스크롤을 빠르게 위로 올릴 때였습니다.  스크롤은 최상단으로 갔지만 "],["activeId",[["c"]]],["는 중간 어디쯤에 멈춰있는 현상을 확인했습니다. intersection observer 방법을 사용하는 다른 블로그들에서도 같은 문제를 확인할 수 있었습니다."]]},"created_time":1700551125439,"last_edited_time":1700555272923,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"8166245c-5fec-476e-8b37-5dc7287a01fc":{"value":{"id":"8166245c-5fec-476e-8b37-5dc7287a01fc","version":77,"type":"image","properties":{"size":[["112.1KB"]],"title":[["스크린샷 2023-11-21 오후 4.26.17.png"]],"source":[["https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/d031988d-349f-4995-87fb-33377f19ea1a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-11-21_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.26.17.png"]],"caption":[["rootMargin"]]},"format":{"block_width":528,"display_source":"https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/d031988d-349f-4995-87fb-33377f19ea1a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-11-21_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.26.17.png","block_full_width":false,"block_page_width":false,"block_aspect_ratio":0.5487804878048781,"block_preserve_scale":true},"created_time":1700551656546,"last_edited_time":1700551779401,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"file_ids":["d031988d-349f-4995-87fb-33377f19ea1a"],"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"a680e6ac-4cca-4e8d-b9f1-024b9529c89f":{"value":{"id":"a680e6ac-4cca-4e8d-b9f1-024b9529c89f","version":1711,"type":"text","properties":{"title":[["h 태그처럼 비교적 작은 크기를 가지는 대상을 비동기적으로 감시할 수 있지만 작은 "],["rootMargin",[["c"]]],["으로 인해 쓰로틀링이 적용된 것과 같이 동작하는 것이 원인이었습니다. "]]},"created_time":1700551283833,"last_edited_time":1700555288884,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"06b1da6f-a5d6-44d5-bf2d-554dabe6b103":{"value":{"id":"06b1da6f-a5d6-44d5-bf2d-554dabe6b103","version":1005,"type":"text","properties":{"title":[["정확한 내부 로직이나 최적화를 확인할 수 없어 아쉬움이 남지만 한 viewport 안에 여러 개의 h 태그가 존재할 수 있는 블로그 글 특성상 한계를 느껴 다음 방법을 진행하게 되었습니다."]]},"created_time":1700551733038,"last_edited_time":1700555295338,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"c7dc16bc-69cd-4bdc-a5d6-dba1eea7d72c":{"value":{"id":"c7dc16bc-69cd-4bdc-a5d6-dba1eea7d72c","version":248,"type":"sub_header","properties":{"title":[["h 태그의 위치를 구하고 계산하여 활용"]]},"created_time":1700483015294,"last_edited_time":1700552336063,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"8ecda611-74bc-4825-aa18-a92f776cd588":{"value":{"id":"8ecda611-74bc-4825-aa18-a92f776cd588","version":1912,"type":"text","properties":{"title":[["저는 이미 scrollY 값을 활용하는 스크롤 진행 바를 구현했습니다. "],["framer-motion",[["c"]]],["에서 제공하는 "],["useScroll",[["c"]]],["의 내부 로직을 확인해 보니 스크롤 이벤트 등록과 clean up 함수 또한 잘 설정되어 있어 또 같은 내용을 구현하기보다 이를 활용하였습니다."]]},"created_time":1700483084275,"last_edited_time":1700555310201,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"40485108-7c8c-42cb-9a49-c8af90dbad4f":{"value":{"id":"40485108-7c8c-42cb-9a49-c8af90dbad4f","version":716,"type":"text","properties":{"title":[["이전에는 notion-h를 class로 가진 엘리먼트 그 자체를 배열로 만들었다면 이번에는 id, 위치를 객체로 만들어 ref에 배열로 담았습니다."]]},"created_time":1700552640990,"last_edited_time":1700553564409,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"4e2cde4d-3609-4ee2-8497-45ed5375f7a4":{"value":{"id":"4e2cde4d-3609-4ee2-8497-45ed5375f7a4","version":190,"type":"code","properties":{"title":[["const hElementPositions = useRef\u003chElementPositionRefType[]\u003e();\n...\nconst getHTagPositions = () =\u003e {\n\t\tconst pageTop = 201; //default page top\n\t  hElementPositions.current = Array.from(\n      document.querySelectorAll\u003cHTMLElement\u003e(\".notion-h\"),\n    )\n      .filter(header =\u003e header.querySelector(\".notion-h-title\")?.textContent)\n      .map(header =\u003e ({\n        id: header.dataset.id as string,\n        top: header.offsetTop + pageTop,\n      }));\n};"]],"language":[["JavaScript"]]},"created_time":1700552824472,"last_edited_time":1700553545384,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"d3ac7588-ee1e-4531-a47b-5e6eb87e2e64":{"value":{"id":"d3ac7588-ee1e-4531-a47b-5e6eb87e2e64","version":56,"type":"sub_sub_header","properties":{"title":[["구현 코드"]]},"created_time":1700553051299,"last_edited_time":1700553366243,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"d5f729d7-7b8b-46bf-8587-2dd220420b7c":{"value":{"id":"d5f729d7-7b8b-46bf-8587-2dd220420b7c","version":36,"type":"code","properties":{"title":[["import { useMotionValueEvent, useScroll } from \"framer-motion\";\nimport { useRef, useState } from \"react\";\n\ninterface hElementPositionRefType {\n  id: string;\n  top: number;\n}\n\nconst useScrollSpy = () =\u003e {\n  const hElementPositions = useRef\u003chElementPositionRefType[]\u003e();\n  const [activeId, setActiveId] = useState(\"\");\n  const { scrollY } = useScroll();\n\n  const getHTagPositions = () =\u003e {\n    ...\n  };\n\n  useMotionValueEvent(scrollY, \"change\", latest =\u003e {\n    getHTagPositions();\n    let headingId = \"\";\n    if (hElementPositions.current) {\n      for (let i = 0; i \u003c hElementPositions.current.length; i++) {\n        if (latest \u003e= hElementPositions.current[i].top) {\n          headingId = hElementPositions.current[i].id;\n          continue;\n        }\n        break;\n      }\n\t\t\tsetActiveId(headingId);\n    }\n  });\n\n  return activeId;\n};\n\nexport default useScrollSpy;"]],"language":[["JavaScript"]]},"created_time":1700553375524,"last_edited_time":1700553984035,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"6b065727-60e9-4449-946a-19ccd9c9f866":{"value":{"id":"6b065727-60e9-4449-946a-19ccd9c9f866","version":804,"type":"text","properties":{"title":[["이벤트가 발생하면 배열을 순회하며 현재 scrollY(latest)가 엘리먼트의 위치보다 크거나 같은 경우 "],["headingId",[["c"]]],["를 바꾸고 작다면 for문을 빠져나와 상태를 변경하도록 구현했습니다."]]},"created_time":1700553392566,"last_edited_time":1700554010917,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"b111b199-fdb7-40d8-ae71-46187b0c1df4":{"value":{"id":"b111b199-fdb7-40d8-ae71-46187b0c1df4","version":42,"type":"sub_sub_header","properties":{"title":[["문제점"]]},"created_time":1700554011212,"last_edited_time":1700554013805,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"7a1df1d5-52f0-4ea0-821f-2670758e3d77":{"value":{"id":"7a1df1d5-52f0-4ea0-821f-2670758e3d77","version":2398,"type":"text","properties":{"title":[["useMotionValueEvent",[["c"]]],[" 내부에 "],["getHTagPositions",[["c"]]],[" 함수가 이벤트마다 다시 계산되는 것을 확인할 수 있습니다. 이유는 블로그를 직접 만들며 "],["react-notion-x",[["c"]]],["의 이미지 렌더링에서 문제가 발생했는데요. content layout shift가 일어난다는 점입니다. 스켈레톤과 같은 최적화 기법으로 이를 해결할 수 있지만 라이브러리의 특성상 커스터마이징에 어려움을 겪어 스크롤이 일어날 때 위치를 다시 구해서 이를 해결하고자 했습니다."]]},"created_time":1700554013999,"last_edited_time":1700555352101,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"3c559b74-c9ba-4422-9b9d-f7d9d9101a9f":{"value":{"id":"3c559b74-c9ba-4422-9b9d-f7d9d9101a9f","version":17,"type":"image","properties":{"size":[["6.6KB"]],"title":[["스크린샷 2023-10-18 오전 2.50.44.png"]],"source":[["https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/8c9d15bc-22a1-443c-a677-478d941df38e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-10-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_2.50.44.png"]]},"format":{"block_width":293,"block_height":48,"display_source":"https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/8c9d15bc-22a1-443c-a677-478d941df38e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-10-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_2.50.44.png","block_full_width":false,"block_page_width":false,"block_aspect_ratio":0.16382252559726962,"block_preserve_scale":true},"created_time":1700554346153,"last_edited_time":1700554372019,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"file_ids":["8c9d15bc-22a1-443c-a677-478d941df38e"],"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"9a14e698-feef-4e5d-a870-227c5a854cbb":{"value":{"id":"9a14e698-feef-4e5d-a870-227c5a854cbb","version":463,"type":"text","properties":{"title":[["시간을 측정해 본 결과 정상적인 범위 안에서 계산이 일어나는 경우 충분히 빠르다는 점을 확인하고 이런 방법을 채택했습니다."]]},"created_time":1700554261808,"last_edited_time":1700555365353,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"33bbb80c-639a-43bd-b156-d6c93b362277":{"value":{"id":"33bbb80c-639a-43bd-b156-d6c93b362277","version":353,"type":"text","properties":{"title":[["결과적으로 이런 과정을 거치며 스스로도 만족할 수 있는 스크롤 스파이 기능을 구현할 수 있었습니다."]]},"created_time":1700554399732,"last_edited_time":1700554640883,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"9cc5826d-c893-4ab4-ab73-3b917d97d86f":{"value":{"id":"9cc5826d-c893-4ab4-ab73-3b917d97d86f","version":70,"type":"image","properties":{"size":[["134.8KB"]],"title":[["Nov-21-2023 17-17-00.gif"]],"source":[["https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/aa5cf378-4b9f-41ae-835b-9d11493cfa52/Nov-21-2023_17-17-00.gif"]],"caption":[["요란한 확인"]]},"format":{"block_width":240,"block_height":328,"display_source":"https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/aa5cf378-4b9f-41ae-835b-9d11493cfa52/Nov-21-2023_17-17-00.gif","block_full_width":false,"block_page_width":false,"block_aspect_ratio":1.3666666666666667,"block_preserve_scale":true},"created_time":1700554630634,"last_edited_time":1700554648046,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"file_ids":["aa5cf378-4b9f-41ae-835b-9d11493cfa52"],"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"2dade119-a1ea-4891-af5e-2b063463879e":{"value":{"id":"2dade119-a1ea-4891-af5e-2b063463879e","version":65,"type":"header","properties":{"title":[["마치며"]]},"created_time":1700554651642,"last_edited_time":1700554664785,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"a571b493-2edc-4f04-a7d9-e8d42d962bc8":{"value":{"id":"a571b493-2edc-4f04-a7d9-e8d42d962bc8","version":2309,"type":"text","properties":{"title":[["블로그를 직접 구현하며 모든 기능들에 관심을 가지고 만들었지만 특히 기억에 남는 내용을 작성해보았습니다. 간단할 수 있는 스크롤 스파이를 구현이지만 제가 겪었던 문제점들과 삽질을 누군가 경험하기 전에 확인한다면 시간을 아낄 수 있지 않을까 생각합니다. 그리고 다시 한번 느꼈지만 각 방법에는 장단점이 존재하고 어떤 선택을 하는지는 개발자의 판단이라는 부분에서 개발의 즐거움을 또 한번 느끼게 되었습니다."]]},"created_time":1700554702747,"last_edited_time":1700555059184,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"ced34dd7-dd90-4cc1-a5f7-db47546e05cc":{"value":{"id":"ced34dd7-dd90-4cc1-a5f7-db47546e05cc","version":405,"type":"text","properties":{"title":[["목표로 하는 일이 잘 안풀리기도 하지만 끈기를 가지고 또 원인을 찾는 즐거움을 잊지 않는 개발자가 되어야 겠습니다."]]},"created_time":1700555060130,"last_edited_time":1700555103169,"parent_id":"2f519016-0752-47a6-9142-08cb1d04bd10","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"}},"collection":{"77251464-f92c-498c-8ec6-b1ee5950601b":{"value":{"id":"77251464-f92c-498c-8ec6-b1ee5950601b","version":77,"name":[["포스팅"]],"schema":{"H`Il":{"name":"Main","type":"checkbox"},"LkE\u003e":{"name":"Summary","type":"text"},"Q[~X":{"name":"Tags","type":"multi_select","options":[{"id":"036731bb-69f1-47c2-899c-76ebd0c4c21d","color":"purple","value":"Next.js"},{"id":"e30a7966-4eb2-45a7-b1f3-314cd0d2c5b0","color":"default","value":"TailwindCSS"},{"id":"f1dcbd9b-69e5-4564-99d8-b65fb51b0090","color":"gray","value":"브라우저"},{"id":"dcc8bb71-28e8-4ef7-8f0b-1922c0daf129","color":"brown","value":"React"},{"id":"3ee98ab1-0b9d-430b-93da-cf2a2ca2f036","color":"pink","value":"lighthouse"},{"id":"eef9ed94-f853-4b17-a817-2ac412387220","color":"orange","value":"회고"},{"id":"15f9af90-4308-4dba-acf4-1565f1b3108b","color":"red","value":"팀 프로젝트"},{"id":"75511c74-11a3-492e-ac8a-8150f5e072b2","color":"green","value":"CS"},{"id":"7982bf8b-df3e-4377-b1b9-84dc37c9ec2b","color":"default","value":"개인 프로젝트"},{"id":"73ce9024-d165-44c8-8821-c0808ab04cb9","color":"yellow","value":"프론트엔드"},{"id":"4865bdba-a3d4-48bd-83a7-7458b532dc9e","color":"default","value":"metrics"},{"id":"755884b4-bddc-4cb4-9bc8-84d0d5d29955","color":"blue","value":"flushSync"},{"id":"69e1ad87-e25d-44b0-865a-be86ed1589c4","color":"blue","value":"JavaScript"},{"id":"b7b6126d-26cf-4a98-8057-873aad8b6cd4","color":"pink","value":"Notion"},{"id":"2bcdc16c-6690-496f-944a-f21d1db899b6","color":"blue","value":"module"}]},"[eXF":{"name":"Title","type":"text"},"title":{"name":"Slug","type":"title"}},"format":{"property_visibility":[{"property":"Q[~X","visibility":"hide"},{"property":"H`Il","visibility":"hide"},{"property":"LkE\u003e","visibility":"hide"},{"property":"[eXF","visibility":"hide"}],"collection_page_properties":[{"visible":true,"property":"Q[~X"}]},"parent_id":"f49dbc55-2ac0-4786-b9e3-4b9522a6a294","parent_table":"block","alive":true,"migrated":true,"space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e","deleted_schema":{"\u003eHgf":{"name":"AI 요약","type":"text","ai_inference":{"type":"summarize","auto_update_on_edit":false}}}},"role":"reader"}},"collection_view":{"2943edd6-04c4-497c-9810-5b340d73025b":{"value":{"id":"2943edd6-04c4-497c-9810-5b340d73025b","version":34,"type":"table","format":{"table_wrap":true,"table_properties":[{"width":77,"visible":true,"property":"H`Il"},{"width":167,"visible":true,"property":"title"},{"width":200,"visible":true,"property":"[eXF"},{"width":200,"visible":true,"property":"Q[~X"},{"width":200,"visible":true,"property":"LkE\u003e"}],"collection_pointer":{"id":"77251464-f92c-498c-8ec6-b1ee5950601b","table":"collection","spaceId":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"table_frozen_column_index":-1},"parent_id":"f49dbc55-2ac0-4786-b9e3-4b9522a6a294","parent_table":"block","alive":true,"page_sort":["df5fe329-5fa8-4852-826b-441b0ca8ed95","a92f06fe-b685-4060-8fe8-6e532683cde4","f32de19b-da8d-49cb-84ce-e509b82600ce","bd0a0d15-7c73-440d-a557-47e29417f68a","08cc1d27-2908-4a9b-a1cc-38db1009da25","d9717ebe-4fc8-4fd5-9336-393fabc3574b","876b9a0c-1d3d-486b-8f7e-2e550187fbcc","0b1f8158-2ece-49da-9c00-f95c4b657a41","b3fdc8c9-3b8f-48bd-91af-5ea70ce1193d","5973748b-61e7-4d92-999e-ad082353606f","6da84544-75f7-436a-8228-8df0315ac183","549d7ee1-51ab-445e-92a9-5d9851ebd792","adc18887-c0d6-4db5-908c-873d849a02ef","babf25bd-0c2c-43d8-98d9-b85ecadd83dc","55e39890-1d23-42ad-aa73-f4fe7d545329","d370f701-4efb-4e4a-8ed5-bdcdec7a1738","6da47cc3-3384-4d52-8b34-e0cf97e5caf9","2f519016-0752-47a6-9142-08cb1d04bd10","ca40eb29-4355-4fc0-9996-a1f2df00ae3b","11ad81a4-5904-437c-a419-80ba4058c34a","55776695-9cf1-47ac-ad84-8f83bd2ecf3c","be15ca6b-9722-434e-8904-9474982454fd"],"space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"}},"space":{},"notion_user":{},"collection_query":{},"signed_urls":{}},"tableOfContents":[{"id":"3b17e509-6562-4bc1-a34b-ebfb0253b731","type":"header","text":"TOC(Table of contents)","indentLevel":0},{"id":"aed5012a-26a3-46e1-9776-1ca64c703db8","type":"header","text":"스크롤 스파이","indentLevel":0},{"id":"845a2c9c-9a90-41ab-a263-f065e49b24ac","type":"sub_header","text":"Intersection Observer 활용","indentLevel":1},{"id":"93705485-f603-4db6-90d4-de7c99f21693","type":"sub_sub_header","text":"구현 코드","indentLevel":2},{"id":"4c6f88e4-9b15-4b7a-a2ba-32043b3ddd05","type":"sub_sub_header","text":"문제점","indentLevel":2},{"id":"c7dc16bc-69cd-4bdc-a5d6-dba1eea7d72c","type":"sub_header","text":"h 태그의 위치를 구하고 계산하여 활용","indentLevel":1},{"id":"d3ac7588-ee1e-4531-a47b-5e6eb87e2e64","type":"sub_sub_header","text":"구현 코드","indentLevel":2},{"id":"b111b199-fdb7-40d8-ae71-46187b0c1df4","type":"sub_sub_header","text":"문제점","indentLevel":2},{"id":"2dade119-a1ea-4891-af5e-2b063463879e","type":"header","text":"마치며","indentLevel":0}]},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"blog-scroll-spy"},"buildId":"B0Yfy3owCS4DCUZlgyOKx","isFallback":false,"dynamicIds":[635,1794],"gsp":true,"scriptLoader":[]}</script></body></html>