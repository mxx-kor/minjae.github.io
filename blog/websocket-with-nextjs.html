<!DOCTYPE html><html lang="ko" class="scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:locale" content="ko-KR"/><meta property="og:site_name" content="minjae blog"/><meta name="author" content="Minjae Kim"/><title>WebSocket 활용기 with Next.js, Socket.io</title><meta name="robots" content="index,follow"/><meta name="description" content="서버 구축 없이 Next.js로 리얼 타임 채팅 토이 프로젝트 구현기"/><meta property="og:title" content="WebSocket 활용기 with Next.js, Socket.io"/><meta property="og:description" content="서버 구축 없이 Next.js로 리얼 타임 채팅 토이 프로젝트 구현기"/><meta property="og:url" content="https://mxx-kor.github.io/blog/websocket-with-nextjs"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2023-12-31T07:51:00.000Z"/><meta property="article:modified_time" content="2024-02-19T12:21:00.000Z"/><meta property="article:author" content="https://github.com/mxx-kor"/><meta property="article:tag" content="Next.js"/><meta property="article:tag" content="websocket"/><meta property="og:image" content="https://avatars.githubusercontent.com/u/82329983?v=4"/><meta property="og:image:width" content="285"/><meta property="og:image:height" content="167"/><link rel="canonical" href="https://mxx-kor.github.io/blog/websocket-with-nextjs"/><meta name="next-head-count" content="21"/><meta name="google-site-verification" content="XJtOBpU5U3tModhdmzxqFas0xo0_saGhnWxPEAC-NHk"/><link rel="preload" href="/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/de5f35e2b8d4bc52-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/91d855b67a63e74f-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/ae11f023272d3641-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/bff605305ca72295-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/0bb6dc123aa42fb6-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/61cc7115f3689ea3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/61cc7115f3689ea3.css" data-n-g=""/><link rel="preload" href="/_next/static/css/3236e1a678526afc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3236e1a678526afc.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script defer="" src="/_next/static/chunks/3607272e.2e699c1bc0d79620.js"></script><script defer="" src="/_next/static/chunks/853.cf688abe519004d8.js"></script><script defer="" src="/_next/static/chunks/794.2b85bc94a9efc2f7.js"></script><script src="/_next/static/chunks/webpack-67524068141b916b.js" defer=""></script><script src="/_next/static/chunks/framework-305cb810cde7afac.js" defer=""></script><script src="/_next/static/chunks/main-34577be56dd3d97c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-a92c6c5f9eb7f8c3.js" defer=""></script><script src="/_next/static/chunks/239-569a8cd56c4de129.js" defer=""></script><script src="/_next/static/chunks/551-b3fc15b50b249083.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-12e204b17f2da5c2.js" defer=""></script><script src="/_next/static/DB43IG3Rp7SS1b-GPkLIQ/_buildManifest.js" defer=""></script><script src="/_next/static/DB43IG3Rp7SS1b-GPkLIQ/_ssgManifest.js" defer=""></script><style id="__jsx-399773665">:root{--font-sans:'__Inter_d9825c', '__Inter_Fallback_d9825c';--font-spoqa:'__fontSpoqa_fca923', '__fontSpoqa_Fallback_fca923'}</style></head><body class="text-primary bg-primary transition-[background]"><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="container mx-auto max-w-screen-md px-6 font-spoqa"><header class="flex justify-between py-6"><ul class="flex items-center gap-4"><li class="font-sans font-medium"><a class="text-tertiary hover:text-secondary" href="/">Home</a></li><li class="font-sans font-medium"><a class="text-primary font-bold hover:text-secondary" href="/blog">Blog</a></li><li class="font-sans font-medium"><a class="text-tertiary hover:text-secondary" href="/archives">Archives</a></li><li class="font-sans font-medium"><a class="text-tertiary hover:text-secondary" href="/about">About</a></li></ul></header><div class="fixed left-0 top-0 z-10 h-1.5 w-full origin-top-left bg-gradient-to-r from-blue-400 to-sky-600 dark:from-stone-700 dark:to-stone-200" style="transform:scaleX(0) translateZ(0)"></div><a class="mb-6 inline-block" href="/blog"><button aria-label="Back to posts" type="button" class="hover:bg-secondary flex h-9 items-center justify-center rounded-lg transition-all w-32"><div class="flex items-center text-md gap-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"></path><path d="M8 7v4L2 6l6-5v4h5a8 8 0 1 1 0 16H4v-2h9a6 6 0 1 0 0-12H8z"></path></g></svg><span>Back to posts</span></div></button></a><article><aside class="sticky top-12 hidden xl:block"><div class="absolute left-full w-64 rounded-2xl p-4"><h2 class="tracking-tight mb-4 text-lg font-bold">목차</h2><ul class="mb-2"><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all text-base hover:font-normal" href="/blog/websocket-with-nextjs#10dfc0a4c7634422981ac4b95a412977">서론</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all ml-4 text-sm hover:font-normal" href="/blog/websocket-with-nextjs#da7a2ef930ac4c52b2b46dab64164385">버전 정보</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all text-base hover:font-normal" href="/blog/websocket-with-nextjs#3d2bfca87478488ea2427332795e7e7a">서버 세팅</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all ml-4 text-sm hover:font-normal" href="/blog/websocket-with-nextjs#9a8a4096d47145a5b49763510930ce65">문제점1 - app router와의 호환성</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all ml-10 text-sm hover:font-normal" href="/blog/websocket-with-nextjs#1b299f0e0f97425cb07e37fc90b83f0d">구현 with TS</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all text-base hover:font-normal" href="/blog/websocket-with-nextjs#ef4d44b61e2d41b0adcb76ba25a53f1e">클라이언트 구현</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all ml-4 text-sm hover:font-normal" href="/blog/websocket-with-nextjs#ac2a61e2d88249258805df86390e2860">연결 관련 이벤트 등록</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all ml-4 text-sm hover:font-normal" href="/blog/websocket-with-nextjs#f8a5f085a14542c68186f3ecd665bd92">메시지 이벤트</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all ml-10 text-sm hover:font-normal" href="/blog/websocket-with-nextjs#658aaa8f86574e988c368e7ede8169e2">chatHandler</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all text-base hover:font-normal" href="/blog/websocket-with-nextjs#2e0bedf70c42448788cde9132bdbd9f3">결과물</a></li><li class="mb-1 font-light tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all text-base hover:font-normal" href="/blog/websocket-with-nextjs#306d9cc6fa6648759e5f78793683c222">마치며</a></li></ul><div class="bg-tag flex w-44 justify-between gap-2 rounded-xl px-4"><a href="/blog"><button aria-label="icon-button" type="button" class="hover:bg-secondary flex h-9 w-9 items-center justify-center rounded-lg transition-all"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"></path><path d="M8 7v4L2 6l6-5v4h5a8 8 0 1 1 0 16H4v-2h9a6 6 0 1 0 0-12H8z"></path></g></svg></button></a><button aria-label="icon-button" type="button" class="hover:bg-secondary flex h-9 w-9 items-center justify-center rounded-lg transition-all"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="22" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355a8 8 0 0 0-12.6 0l-112 141.7a7.98 7.98 0 0 0 6.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z"></path></svg></button><button aria-label="icon-button" type="button" class="hover:bg-secondary flex h-9 w-9 items-center justify-center rounded-lg transition-all"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="22" width="22" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"></path><path d="M14 22.5L11.2 19H6a1 1 0 0 1-1-1V7.103a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1V18a1 1 0 0 1-1 1h-5.2L14 22.5zm1.839-5.5H21V8.103H7V17H12.161L14 19.298 15.839 17zM2 2h17v2H3v11H1V3a1 1 0 0 1 1-1z"></path></g></svg></button></div></div></aside><section><h1 class="mb-2 break-keep text-center text-3xl font-bold">WebSocket 활용기 with Next.js, Socket.io</h1><div class="flex items-center gap-1 text-tertiary mb-2 justify-center text-sm"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg><span>2023.12.31</span></div><div class="mb-4 flex justify-center gap-2"><a href="/archives/tags/Next.js"><span class="inline-flex items-center rounded-md px-2 py-1 text-tertiary bg-tag text-xs font-medium hover:bg-secondary ring-1 ring-inset ring-gray-500/10 transition-all">Next.js</span></a><a href="/archives/tags/websocket"><span class="inline-flex items-center rounded-md px-2 py-1 text-tertiary bg-tag text-xs font-medium hover:bg-secondary ring-1 ring-inset ring-gray-500/10 transition-all">websocket</span></a></div></section><section class="transition-all xl:hidden"><hr class="border-neutral-300 w-full border-1 mb-4 dark:border-neutral-400"/><h2 class="text-2xl font-bold tracking-tight mb-2 px-2"><div class="flex items-center gap-3 text-xl font-bold"><svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 24 24" height="25" width="25" xmlns="http://www.w3.org/2000/svg"><path d="M2 8C2 7.44772 2.44772 7 3 7H21C21.5523 7 22 7.44772 22 8C22 8.55228 21.5523 9 21 9H3C2.44772 9 2 8.55228 2 8Z" fill="currentColor"></path><path d="M2 12C2 11.4477 2.44772 11 3 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H3C2.44772 13 2 12.5523 2 12Z" fill="currentColor"></path><path d="M3 15C2.44772 15 2 15.4477 2 16C2 16.5523 2.44772 17 3 17H15C15.5523 17 16 16.5523 16 16C16 15.4477 15.5523 15 15 15H3Z" fill="currentColor"></path></svg><span>Table of Contents</span></div></h2><ul class="px-2"><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/websocket-with-nextjs#10dfc0a4c7634422981ac4b95a412977"><div class="flex items-center gap-1 text-base"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>서론</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/websocket-with-nextjs#da7a2ef930ac4c52b2b46dab64164385"><div class="flex items-center gap-1 ml-8 text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>버전 정보</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/websocket-with-nextjs#3d2bfca87478488ea2427332795e7e7a"><div class="flex items-center gap-1 text-base"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>서버 세팅</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/websocket-with-nextjs#9a8a4096d47145a5b49763510930ce65"><div class="flex items-center gap-1 ml-8 text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>문제점1 - app router와의 호환성</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/websocket-with-nextjs#1b299f0e0f97425cb07e37fc90b83f0d"><div class="flex items-center gap-1 ml-16 text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>구현 with TS</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/websocket-with-nextjs#ef4d44b61e2d41b0adcb76ba25a53f1e"><div class="flex items-center gap-1 text-base"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>클라이언트 구현</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/websocket-with-nextjs#ac2a61e2d88249258805df86390e2860"><div class="flex items-center gap-1 ml-8 text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>연결 관련 이벤트 등록</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/websocket-with-nextjs#f8a5f085a14542c68186f3ecd665bd92"><div class="flex items-center gap-1 ml-8 text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>메시지 이벤트</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/websocket-with-nextjs#658aaa8f86574e988c368e7ede8169e2"><div class="flex items-center gap-1 ml-16 text-sm"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>chatHandler</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/websocket-with-nextjs#2e0bedf70c42448788cde9132bdbd9f3"><div class="flex items-center gap-1 text-base"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>결과물</span></div></a></li><li class="mb-1 tracking-tighter"><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/websocket-with-nextjs#306d9cc6fa6648759e5f78793683c222"><div class="flex items-center gap-1 text-base"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd"></path></svg><span>마치며</span></div></a></li></ul></section><main class="notion dark-mode notion-page notion-block-1470f21883824dfbbd46defda19e2bda"><div class="notion-viewport"></div><div class="notion-collection-page-properties"><div class="notion-collection-row"><div class="notion-collection-row-body"></div></div></div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-10dfc0a4c7634422981ac4b95a412977" data-id="10dfc0a4c7634422981ac4b95a412977"><span><div id="10dfc0a4c7634422981ac4b95a412977" class="notion-header-anchor"></div><a class="notion-hash-link" href="#10dfc0a4c7634422981ac4b95a412977" title="서론"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">서론</span></span></h2><div class="notion-text notion-block-ba97cd39179c40dda14b0808e4edd29f">팀 프로젝트에서 심지어 이력서도 Figma로 작성할 정도로 정말 잘 활용하고 있었다. 문득 실시간으로 다른 사람들과 작업할 수 있는 네트워크를 어떻게 구현했을까라는 생각이 들었고 개발자 도구를 확인했다.</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-1715d55f93e3447a912d67800ce13fe1"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:336px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F7b0c1ebf-29f7-4bde-9810-55e79a3d582e%2Fa82a0cfd-1d08-445e-b3a9-382b5f601983%2FfigmaWS.gif?table=block&amp;id=1715d55f-93e3-447a-912d-67800ce13fe1&amp;cache=v2" alt="선긋기와 개발자 도구" loading="lazy" decoding="async"/><figcaption class="notion-asset-caption">선긋기와 개발자 도구</figcaption></div></figure><div class="notion-text notion-block-b1eefd68c0554737919a8dc7d906bbb6">양방향 데이터 전송이 <code class="notion-inline-code">WebSocket</code>을 통해 이뤄진다는 점을 확인했다. 토이 프로젝트를 통해 경험해보고 싶다는 생각을 했고 간단한 채팅 애플리케이션을 떠올리게 되었다. 프로젝트를 시작하기 앞서 HTTP 통신과 관련 내용들에 대해 학습하고 정리하였으나 이번 글에서는 다루지 않을 예정이다.</div><div class="notion-text notion-block-f38368c0b452416eb7b9d1be4ad095d6">이 과정에서 <code class="notion-inline-code">Next.js</code> 13버전과 <code class="notion-inline-code">Socket.io</code>를 활용했고 이전에 새로운 버전의 <code class="notion-inline-code">Next.js</code> 연습하기 위해 세팅해두었던 프로젝트에 새로운 페이지를 생성하며 시작했다.</div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-da7a2ef930ac4c52b2b46dab64164385" data-id="da7a2ef930ac4c52b2b46dab64164385"><span><div id="da7a2ef930ac4c52b2b46dab64164385" class="notion-header-anchor"></div><a class="notion-hash-link" href="#da7a2ef930ac4c52b2b46dab64164385" title="버전 정보"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">버전 정보</span></span></h3><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-json">&quot;next&quot;: &quot;13.4.12&quot;,
&quot;socket.io&quot;: &quot;^4.7.2&quot;,
&quot;socket.io-client&quot;: &quot;^4.7.2&quot;</code></pre><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-3d2bfca87478488ea2427332795e7e7a" data-id="3d2bfca87478488ea2427332795e7e7a"><span><div id="3d2bfca87478488ea2427332795e7e7a" class="notion-header-anchor"></div><a class="notion-hash-link" href="#3d2bfca87478488ea2427332795e7e7a" title="서버 세팅"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">서버 세팅</span></span></h2><div class="notion-text notion-block-9542d909a7f047dda2c0c2accdcb631e"><code class="notion-inline-code">Node.js</code>를 통해 백엔드 서버를 직접 구현해야 한다는 점과 서버가 켜져 있어야 한다는 불편함에 <code class="notion-inline-code">Next.js</code>의 백엔드 기능(Route Handlers)을 활용해 서버를 구축하기로 결정하게 되었다. 그리고 편의성을 제공하는 라이브러리인 <code class="notion-inline-code">Socket.io</code>를 선택했다.</div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-9a8a4096d47145a5b49763510930ce65" data-id="9a8a4096d47145a5b49763510930ce65"><span><div id="9a8a4096d47145a5b49763510930ce65" class="notion-header-anchor"></div><a class="notion-hash-link" href="#9a8a4096d47145a5b49763510930ce65" title="문제점1 - app router와의 호환성"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">문제점1 - app router와의 호환성</span></span></h3><div class="notion-text notion-block-ffb43060ae984c76b36fcc01f6600fe6">시작하자마자 문제가 생겼다. 13버전의 app router의 router handler와 pages router의 API routes는 다른 방법으로 코드를 작성해야 한다. </div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">// Route Handlers
export async function GET(request: Request) {}</code></pre><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">// API routes
export default function handler(req, res) {}</code></pre><div class="notion-text notion-block-43c8efef918d4ba8a5795770e98f1b7e">우선 pages router의 <b>API Routes를 활용한 방법을 채택</b>하고 구현하게 되었다. </div><blockquote class="notion-quote notion-block-d88ed03374414371b666c49665d2332d"><div>이유 1 - <code class="notion-inline-code">Next.js</code>와 <code class="notion-inline-code">Socket.io</code>를 연결할 방법이 없다.</div></blockquote><div class="notion-text notion-block-8b184e9a7eaf40edb0c36bf57f87643e">코드를 작성하며 느꼈던 문제는 Next의 서버 인스턴스를 받아 이를 <code class="notion-inline-code">Socket.io</code>와 연결해야 하는데 그 방법이 제공되지 않는다는 점이였다. 반면 handler의 res를 사용하면 서버의 인스턴스에 접근할 수 있었다.</div><blockquote class="notion-quote notion-block-d4f2f6d43f2443afb1f7578401a543e4"><div>이유 2 - <code class="notion-inline-code">Socket.io</code>와 제대로 호환되지 않는다.</div></blockquote><div class="notion-text notion-block-629c0e29a4b543529b0f83d5c85b2939">추후 서버 연결이 아닌 POST를 처리하는 과정에서도 다시 한번 Route Handlers를 사용해봤으나 역시 호환이 제대로 되지 않아 문제가 발생했다.</div><h4 class="notion-h notion-h3 notion-h-indent-2 notion-block-1b299f0e0f97425cb07e37fc90b83f0d" data-id="1b299f0e0f97425cb07e37fc90b83f0d"><span><div id="1b299f0e0f97425cb07e37fc90b83f0d" class="notion-header-anchor"></div><a class="notion-hash-link" href="#1b299f0e0f97425cb07e37fc90b83f0d" title="구현 with TS"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">구현 with TS</span></span></h4><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">// pages/api/socket/io.ts
import {Server as NetServer} from &#x27;http&#x27;;
import {Socket} from &#x27;net&#x27;;
import {NextApiRequest, NextApiResponse} from &#x27;next&#x27;;
import {Server as ServerIO} from &#x27;socket.io&#x27;;

import {ServerToClientEvents} from &#x27;@/types/socket&#x27;;

export type NextApiResponseServerIO = NextApiResponse &amp; {
  socket: Socket &amp; {
    server: NetServer &amp; {
      io: ServerIO&lt;ServerToClientEvents&gt;;
    };
  };
};

const ioHandler = (req: NextApiRequest, res: NextApiResponseServerIO) =&gt; {
  if (!res.socket.server.io) {
    const httpServer = res.socket.server as NetServer;
    const io = new ServerIO(httpServer, {
      path: &#x27;/api/socket/io&#x27;,
      addTrailingSlash: false,
    });

    res.socket.server.io = io;
  }

  res.end();
};

export default ioHandler;</code></pre><div class="notion-text notion-block-b2cc77f9936848c3bbe0ffed23f88cd6"><code class="notion-inline-code">Socket.io</code>에 타입스크립트를 적용하기 위해서는 공식 문서를 참고하는 것을 추천드린다. 따로 타입을 지정함으로 자동완성이나 에러를 쉽게 발견할 수 있었다.</div><div class="notion-text notion-block-f21ff6bff27442f49919b375257a7e3f"><a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://socket.io/docs/v4/typescript/">https://socket.io/docs/v4/typescript/</a></div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-ef4d44b61e2d41b0adcb76ba25a53f1e" data-id="ef4d44b61e2d41b0adcb76ba25a53f1e"><span><div id="ef4d44b61e2d41b0adcb76ba25a53f1e" class="notion-header-anchor"></div><a class="notion-hash-link" href="#ef4d44b61e2d41b0adcb76ba25a53f1e" title="클라이언트 구현"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">클라이언트 구현</span></span></h2><div class="notion-text notion-block-f89f49e298de4ad5b81b84b70c9a241a">간단한 애플리케이션이기에 상태 관리 라이브러리를 활용하는 것보다는 <code class="notion-inline-code">Context API</code>와 커스텀훅을 활용했다.</div><div class="notion-text notion-block-b65740fa916c4d35a668e3c2fd5125c6">context로 구현하고 싶은신 분들을 위해 링크로 빼겠습니다.</div><div class="notion-text notion-block-6f5d0110c34d42cab7af54fa90a1217a"><a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://github.com/mxx-kor/nextjs-practice/blob/main/components/provider/SocketProvider.tsx">https://github.com/mxx-kor/nextjs-practice/blob/main/components/provider/SocketProvider.tsx</a></div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-ac2a61e2d88249258805df86390e2860" data-id="ac2a61e2d88249258805df86390e2860"><span><div id="ac2a61e2d88249258805df86390e2860" class="notion-header-anchor"></div><a class="notion-hash-link" href="#ac2a61e2d88249258805df86390e2860" title="연결 관련 이벤트 등록"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">연결 관련 이벤트 등록</span></span></h3><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">// component/provider/SocketProvider.tsx

&#x27;use client&#x27;;

...

export const SocketProvider = ({children}: {children: React.ReactNode}) =&gt; {
  const [socket, setSocket] = useState&lt;ClientSocketType | null&gt;(null);
  const [isConnected, setIsConnected] = useState(false);

  useEffect(() =&gt; {
    const socket: ClientSocketType = io(process.env.NEXT_PUBLIC_SITE_URL!, {
      path: &#x27;/api/socket/io&#x27;,
      addTrailingSlash: false,
    });

    socket.on(&#x27;connect&#x27;, () =&gt; {
      setIsConnected(true);
    });

    socket.on(&#x27;error&#x27;, (error: Error) =&gt; {
      console.error(error);
    });

    socket.on(&#x27;disconnect&#x27;, () =&gt; {
      setIsConnected(false);
    });

    setSocket(socket);

    return () =&gt; {
      if (socket) {
        socket.disconnect();
      }
    };
  }, []);

  ...
};</code></pre><div class="notion-text notion-block-1ef8c491af7349cfa45560562d0a6a6f">서버와 클라이언트가 연결되면 이벤트를 등록하고 chat 페이지에만 socket을 사용하고 있어 해당 페이지의 layout에 provider로 감싸주었다. 그리고 언마운트되면 cleanup function을 통해 정리하도록 구현했다. 제대로 연결되는지 인디케이터를 만들어서 확인해봤다.</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-5e0c2e4a77f5481ca63a6bbe912284d1"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:264px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F7b0c1ebf-29f7-4bde-9810-55e79a3d582e%2F77707b92-c606-4323-986d-c71ae3855f3d%2FDec-31-2023_18-54-56.gif?table=block&amp;id=5e0c2e4a-77f5-481c-a63a-6bbe912284d1&amp;cache=v2" alt="인디케이터로 동작 확인" loading="lazy" decoding="async"/><figcaption class="notion-asset-caption">인디케이터로 동작 확인</figcaption></div></figure><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-f8a5f085a14542c68186f3ecd665bd92" data-id="f8a5f085a14542c68186f3ecd665bd92"><span><div id="f8a5f085a14542c68186f3ecd665bd92" class="notion-header-anchor"></div><a class="notion-hash-link" href="#f8a5f085a14542c68186f3ecd665bd92" title="메시지 이벤트"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">메시지 이벤트</span></span></h3><div class="notion-text notion-block-16dbcbdbf5a54abeb67255132bdbf9ad">socket을 활용한 다른 기능 활용시 메시지 이벤트를 등록하지 않아도 되는지 확인하고 싶어서 chat 페이지에서 이벤트를 등록하는 방법을 활용해봤다. </div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">&#x27;use client&#x27;;

...

import {useSocket} from &#x27;@/components/provider/SocketProvider&#x27;;
import {IMessage} from &#x27;@/types/chat&#x27;;

const Chat = () =&gt; {
  const {socket} = useSocket();
  const [messages, setMessages] = useState&lt;IMessage[]&gt;([]);
	...

  const sendMessage = async () =&gt; {
    if (currentMessage) {
      const res = await fetch(&#x27;/api/chat&#x27;, {
        method: &#x27;POST&#x27;,
        body: JSON.stringify({
          user: username,
          content: currentMessage,
        }),
      });

      if (res.ok) setCurrentMessage(&#x27;&#x27;);
    }
  };

  useEffect(() =&gt; {
    socket?.on(&#x27;message&#x27;, (message: IMessage) =&gt; {
      setMessages((prev) =&gt; [...prev, message]);
    });
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [socket]);

	...

export default Chat;</code></pre><div class="notion-text notion-block-62017d3d453a4735a78d5109c1a23a0e">message를 송수신할 수 있는 이벤트를 socket이 연결되어 있을때 등록하고 상태를 변경하는 방법으로 화면에 표시할 수 있었고 <code class="notion-inline-code">sendMessage</code>함수의 Post 요청을 처리하는 부분의 코드는 아래와 같다.</div><h4 class="notion-h notion-h3 notion-h-indent-2 notion-block-658aaa8f86574e988c368e7ede8169e2" data-id="658aaa8f86574e988c368e7ede8169e2"><span><div id="658aaa8f86574e988c368e7ede8169e2" class="notion-header-anchor"></div><a class="notion-hash-link" href="#658aaa8f86574e988c368e7ede8169e2" title="chatHandler"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">chatHandler</span></span></h4><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">// pages/api/chat.ts
import {NextApiRequest} from &#x27;next&#x27;;
import {IMessage} from &#x27;@/types/chat&#x27;;
import {NextApiResponseServerIO} from &#x27;./socket/io&#x27;;

const chatHandler = (req: NextApiRequest, res: NextApiResponseServerIO) =&gt; {
  if (req.method === &#x27;POST&#x27;) {
    const message = JSON.parse(req.body) as IMessage;

    res.socket.server.io.emit(&#x27;message&#x27;, message);

    res.status(201).json(message);
  }
};

export default chatHandler;</code></pre><blockquote class="notion-quote notion-block-70880d43c92f4a57bc7c8bde14421ad7"><div>또 다른 handler를 작성한 이유</div></blockquote><div class="notion-text notion-block-8b49c436a0c84a5bb36bf6da55c2641f"> <code class="notion-inline-code">sendMessage</code> 안에서 바로 emit을 하는 경우에는 아무 동작도 이루어지지 않는 점 때문이였다. 추론이지만 네트워크 동작을 통해서만 Socket에 접근하고 이벤트를 발생시킬 수 있다고 생각하게 되었다.</div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-2e0bedf70c42448788cde9132bdbd9f3" data-id="2e0bedf70c42448788cde9132bdbd9f3"><span><div id="2e0bedf70c42448788cde9132bdbd9f3" class="notion-header-anchor"></div><a class="notion-hash-link" href="#2e0bedf70c42448788cde9132bdbd9f3" title="결과물"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">결과물</span></span></h2><div class="notion-text notion-block-3d58c4dc2f7c4ad28b866aebf74f7564">3개의 브라우저를 띄우고 메시지를 보내보았다. 나름 이쁜 결과물을 만들기 위해 <code class="notion-inline-code">Mui</code>를 활용했다.</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-be9fc36c15ec44f6b258c0c562e7bdfa"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:640px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F7b0c1ebf-29f7-4bde-9810-55e79a3d582e%2F67868ee4-7a01-4ba4-ad82-675257343532%2FDec-31-2023_19-31-57.gif?table=block&amp;id=be9fc36c-15ec-44f6-b258-c0c562e7bdfa&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-306d9cc6fa6648759e5f78793683c222" data-id="306d9cc6fa6648759e5f78793683c222"><span><div id="306d9cc6fa6648759e5f78793683c222" class="notion-header-anchor"></div><a class="notion-hash-link" href="#306d9cc6fa6648759e5f78793683c222" title="마치며"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">마치며</span></span></h2><div class="notion-text notion-block-6f616937d4524b2ca5669a3939849c75">궁금증으로 시작한 토이 프로젝트가 HTTP 통신에 대한 학습, <code class="notion-inline-code">Next.js</code>의 serverless 백엔드 활용까지 다양한 경험을 이끌게 되었다. 초반에 걱정했던 <code class="notion-inline-code">WebSocket</code>과 <code class="notion-inline-code">Socket.io</code>의 차이점 중 하나인 속도 면에서도 나쁘지 않은 성능을 보여주었다. 신경썼던 타입 적용도 잘 이루어졌다.</div><div class="notion-text notion-block-33d18b1567ab43d5833d4aea07b8dfd2">지금은 정말 간단한 채팅이지만 추후 Figma처럼 공동 작업이나 아예 새로운 기능을 구현해보고 싶다.</div><div class="notion-blank notion-block-8723e8675e8641aa89c020230a07b30c"> </div></main><hr class="border-neutral-300 dark:border-neutral-500 border-1 w-full my-6"/><section class="mb-12 flex justify-between px-2"><div><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/confirm-leaving-page"><div class="flex items-center gap-1 text-xs"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"></path><path d="M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z"></path></g></svg><span>Prev</span></div><span class="tracking-tighter">Next.js App Router 페이지 이동 막기</span></a></div><div><a class="text-mute hover:text-primary inline-block transition-all" href="/blog/functional-programming-currying"><div class="flex items-center gap-1 text-xs justify-end"><span>Next</span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"></path><path d="M16.172 11l-5.364-5.364 1.414-1.414L20 12l-7.778 7.778-1.414-1.414L16.172 13H4v-2z"></path></g></svg></div><span class="tracking-tighter">함수형 프로그래밍 - Curry</span></a></div></section><section></section></article><hr class="border-neutral-300 dark:border-neutral-500 border-1 w-full my-8"/><footer class="mb-10 flex flex-col items-end text-sm"><div class="mx-auto mb-2 flex gap-2 text-xl sm:mx-0"><a target="_blank" href="mailto:minjae7728@gmail.com" rel="noreferrer" aria-label="check author&#x27;s email" class="text-tertiary hover:text-primary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M24 4.5v15c0 .85-.65 1.5-1.5 1.5H21V7.387l-9 6.463-9-6.463V21H1.5C.649 21 0 20.35 0 19.5v-15c0-.425.162-.8.431-1.068C.7 3.16 1.076 3 1.5 3H2l10 7.25L22 3h.5c.425 0 .8.162 1.069.432.27.268.431.643.431 1.068z"></path></svg></a><a target="_blank" href="https://github.com/mxx-kor" rel="noreferrer" aria-label="check author&#x27;s github" class="text-tertiary hover:text-primary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a target="_blank" href="https://www.linkedin.com/in/%EB%AF%BC%EC%9E%AC-%EA%B9%80-35a409204/" rel="noreferrer" aria-label="check author&#x27;s linkedin" class="text-tertiary hover:text-primary"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a></div><p class="text-tertiary mx-auto sm:mx-0"><span>© </span><a class="hover:text-primary hover:underline" href="/about">Minjae Kim</a><span> Powered by </span><a target="_blank" href="https://nextjs.org/" rel="noreferrer" class="hover:text-primary hover:underline">Next.js</a><span>, </span><a target="_blank" href="https://pages.github.com/" rel="noreferrer" class="hover:text-primary hover:underline">Github Pages</a><span>, </span><a target="_blank" href="https://developers.notion.com/" rel="noreferrer" class="hover:text-primary hover:underline">Notion API</a></p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"prevPost":{"object":"page","id":"dfe03591-04f5-4ff9-a101-b551112d7aa0","created_time":"2024-02-19T12:22:00.000Z","last_edited_time":"2024-02-20T07:11:00.000Z","created_by":{"object":"user","id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6"},"last_edited_by":{"object":"user","id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6"},"cover":null,"icon":null,"parent":{"type":"database_id","database_id":"f49dbc55-2ac0-4786-b9e3-4b9522a6a294"},"archived":false,"properties":{"Main":{"id":"H%60Il","type":"checkbox","checkbox":false},"Summary":{"id":"LkE%3E","type":"rich_text","rich_text":[{"type":"text","text":{"content":"페이지 이동을 감지하고 confirm창을 띄우는기 위해 적용한 내용을 다룹니다.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"페이지 이동을 감지하고 confirm창을 띄우는기 위해 적용한 내용을 다룹니다.","href":null}]},"Tags":{"id":"Q%5B~X","type":"multi_select","multi_select":[{"id":"036731bb-69f1-47c2-899c-76ebd0c4c21d","name":"Next.js","color":"purple"}]},"Title":{"id":"%5BeXF","type":"rich_text","rich_text":[{"type":"text","text":{"content":"Next.js App Router 페이지 이동 막기","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Next.js App Router 페이지 이동 막기","href":null}]},"Slug":{"id":"title","type":"title","title":[{"type":"text","text":{"content":"confirm-leaving-page","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"confirm-leaving-page","href":null}]}},"url":"https://www.notion.so/confirm-leaving-page-dfe0359104f54ff9a101b551112d7aa0","public_url":"https://longhaired-way-a70.notion.site/confirm-leaving-page-dfe0359104f54ff9a101b551112d7aa0"},"post":{"object":"page","id":"1470f218-8382-4dfb-bd46-defda19e2bda","created_time":"2023-12-31T07:51:00.000Z","last_edited_time":"2024-02-19T12:21:00.000Z","created_by":{"object":"user","id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6"},"last_edited_by":{"object":"user","id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6"},"cover":null,"icon":null,"parent":{"type":"database_id","database_id":"f49dbc55-2ac0-4786-b9e3-4b9522a6a294"},"archived":false,"properties":{"Main":{"id":"H%60Il","type":"checkbox","checkbox":true},"Summary":{"id":"LkE%3E","type":"rich_text","rich_text":[{"type":"text","text":{"content":"서버 구축 없이 Next.js로 리얼 타임 채팅 토이 프로젝트 구현기","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"서버 구축 없이 Next.js로 리얼 타임 채팅 토이 프로젝트 구현기","href":null}]},"Tags":{"id":"Q%5B~X","type":"multi_select","multi_select":[{"id":"036731bb-69f1-47c2-899c-76ebd0c4c21d","name":"Next.js","color":"purple"},{"id":"2cfb94f8-487f-4e6a-9389-2485549661fe","name":"websocket","color":"green"}]},"Title":{"id":"%5BeXF","type":"rich_text","rich_text":[{"type":"text","text":{"content":"WebSocket 활용기 with Next.js, Socket.io","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"WebSocket 활용기 with Next.js, Socket.io","href":null}]},"Slug":{"id":"title","type":"title","title":[{"type":"text","text":{"content":"websocket-with-nextjs","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"websocket-with-nextjs","href":null}]}},"url":"https://www.notion.so/websocket-with-nextjs-1470f21883824dfbbd46defda19e2bda","public_url":"https://longhaired-way-a70.notion.site/websocket-with-nextjs-1470f21883824dfbbd46defda19e2bda","request_id":"d035a4dd-4613-4acd-99f9-b8b33fc94f0f"},"nextPost":{"object":"page","id":"2f3ab74d-072f-40cc-a37f-55fe452f2b78","created_time":"2023-12-09T11:52:00.000Z","last_edited_time":"2023-12-09T16:35:00.000Z","created_by":{"object":"user","id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6"},"last_edited_by":{"object":"user","id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6"},"cover":null,"icon":null,"parent":{"type":"database_id","database_id":"f49dbc55-2ac0-4786-b9e3-4b9522a6a294"},"archived":false,"properties":{"Main":{"id":"H%60Il","type":"checkbox","checkbox":false},"Summary":{"id":"LkE%3E","type":"rich_text","rich_text":[{"type":"text","text":{"content":"카레..? 커링..? 어떤 불편함을 해결할 수 있을까?","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"카레..? 커링..? 어떤 불편함을 해결할 수 있을까?","href":null}]},"Tags":{"id":"Q%5B~X","type":"multi_select","multi_select":[{"id":"d5eb76a7-b5a6-4de7-976f-fa76f907595d","name":"함수형 프로그래밍","color":"gray"},{"id":"69e1ad87-e25d-44b0-865a-be86ed1589c4","name":"JavaScript","color":"blue"}]},"Title":{"id":"%5BeXF","type":"rich_text","rich_text":[{"type":"text","text":{"content":"함수형 프로그래밍 - Curry","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"함수형 프로그래밍 - Curry","href":null}]},"Slug":{"id":"title","type":"title","title":[{"type":"text","text":{"content":"functional-programming-currying","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"functional-programming-currying","href":null}]}},"url":"https://www.notion.so/functional-programming-currying-2f3ab74d072f40cca37f55fe452f2b78","public_url":"https://longhaired-way-a70.notion.site/functional-programming-currying-2f3ab74d072f40cca37f55fe452f2b78"},"recordMap":{"block":{"1470f218-8382-4dfb-bd46-defda19e2bda":{"value":{"id":"1470f218-8382-4dfb-bd46-defda19e2bda","version":1887,"type":"page","properties":{"H`Il":[["Yes"]],"LkE\u003e":[["서버 구축 없이 Next.js로 리얼 타임 채팅 토이 프로젝트 구현기"]],"Q[~X":[["Next.js,websocket"]],"[eXF":[["WebSocket 활용기 with Next.js, Socket.io"]],"title":[["websocket-with-nextjs"]]},"content":["10dfc0a4-c763-4422-981a-c4b95a412977","ba97cd39-179c-40dd-a14b-0808e4edd29f","1715d55f-93e3-447a-912d-67800ce13fe1","b1eefd68-c055-4737-919a-8dc7d906bbb6","f38368c0-b452-416e-b7b9-d1be4ad095d6","da7a2ef9-30ac-4c52-b2b4-6dab64164385","70d2ad5a-6374-45fe-8f3a-2d02b2593784","3d2bfca8-7478-488e-a242-7332795e7e7a","9542d909-a7f0-47dd-a2c0-c2accdcb631e","9a8a4096-d471-45a5-b497-63510930ce65","ffb43060-ae98-4c76-b36f-cc01f6600fe6","5fc13c6c-139c-4630-b1fc-2779caed8221","4bcede9a-64e7-4e86-b347-4ce9d01c896a","43c8efef-918d-4ba8-a579-5770e98f1b7e","d88ed033-7441-4371-b666-c49665d2332d","8b184e9a-7eaf-40ed-b0c3-6bf57f87643e","d4f2f6d4-3f24-43af-b1f7-578401a543e4","629c0e29-a4b5-4352-9b0f-83d5c85b2939","1b299f0e-0f97-425c-b07e-37fc90b83f0d","c3803ca8-ce20-499c-944d-c28cdc9f2f4e","b2cc77f9-9368-48c3-bbe0-ffed23f88cd6","f21ff6bf-f274-42f4-9919-b375257a7e3f","ef4d44b6-1e2d-41b0-adcb-76ba25a53f1e","f89f49e2-98de-4ad5-b81b-84b70c9a241a","b65740fa-916c-4d35-a668-e3c2fd5125c6","6f5d0110-c34d-42ca-b7af-54fa90a1217a","ac2a61e2-d882-4925-8805-df86390e2860","20401204-2646-418a-8309-cf106cfc6b6d","1ef8c491-af73-49cf-a455-60562d0a6a6f","5e0c2e4a-77f5-481c-a63a-6bbe912284d1","f8a5f085-a145-42c6-8186-f3ecd665bd92","16dbcbdb-f5a5-4abe-b672-55132bdbf9ad","51ffbb77-dfea-4743-8382-18267194d226","62017d3d-453a-4735-a78d-5109c1a23a0e","658aaa8f-8657-4e98-8c36-8e7ede8169e2","d0f758ed-c005-4f6e-a50c-55fa6ddbcc4e","70880d43-c92f-4a57-bc7c-8bde14421ad7","8b49c436-a0c8-4a5b-b36b-f6da55c2641f","2e0bedf7-0c42-4487-88cd-e9132bdbd9f3","3d58c4dc-2f7c-4ad2-8b86-6aebf74f7564","be9fc36c-15ec-44f6-b258-c0c562e7bdfa","306d9cc6-fa66-4875-9e5f-78793683c222","6f616937-d452-4b2c-a566-9a3939849c75","33d18b15-67ab-43d5-833d-4aea07b8dfd2","8723e867-5e86-41aa-89c0-20230a07b30c"],"created_time":1704009072199,"last_edited_time":1708345298360,"parent_id":"77251464-f92c-498c-8ec6-b1ee5950601b","parent_table":"collection","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"f49dbc55-2ac0-4786-b9e3-4b9522a6a294":{"value":{"id":"f49dbc55-2ac0-4786-b9e3-4b9522a6a294","version":117,"type":"collection_view","view_ids":["2943edd6-04c4-497c-9810-5b340d73025b"],"collection_id":"77251464-f92c-498c-8ec6-b1ee5950601b","format":{"collection_pointer":{"id":"77251464-f92c-498c-8ec6-b1ee5950601b","table":"collection","spaceId":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"}},"permissions":[{"role":"editor","type":"user_permission","user_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6"},{"role":"reader","type":"public_permission","added_timestamp":1688473010972,"allow_duplicate":false},{"type":"restricted_permission"},{"role":{"read_content":true},"type":"bot_permission","bot_id":"95ebcfc3-c78e-4f51-8a1d-715c5aee0b0b","parent_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e","parent_table":"space"}],"created_time":1688471518135,"last_edited_time":1708345320708,"parent_id":"6da363e3-8c9b-4c93-a407-b2dfdda51a20","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"10dfc0a4-c763-4422-981a-c4b95a412977":{"value":{"id":"10dfc0a4-c763-4422-981a-c4b95a412977","version":1115,"type":"header","properties":{"title":[["서론"]]},"created_time":1704009438059,"last_edited_time":1704009746165,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"ba97cd39-179c-40dd-a14b-0808e4edd29f":{"value":{"id":"ba97cd39-179c-40dd-a14b-0808e4edd29f","version":21,"type":"text","properties":{"title":[["팀 프로젝트에서 심지어 이력서도 Figma로 작성할 정도로 정말 잘 활용하고 있었다. 문득 실시간으로 다른 사람들과 작업할 수 있는 네트워크를 어떻게 구현했을까라는 생각이 들었고 개발자 도구를 확인했다."]]},"created_time":1704009438059,"last_edited_time":1704018224099,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"1715d55f-93e3-447a-912d-67800ce13fe1":{"value":{"id":"1715d55f-93e3-447a-912d-67800ce13fe1","version":125,"type":"image","properties":{"size":[["642.5KB"]],"title":[["figmaWS.gif"]],"source":[["https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/a82a0cfd-1d08-445e-b3a9-382b5f601983/figmaWS.gif"]],"caption":[["선긋기와 개발자 도구"]]},"format":{"block_width":336,"display_source":"https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/a82a0cfd-1d08-445e-b3a9-382b5f601983/figmaWS.gif","block_full_width":false,"block_page_width":false,"block_aspect_ratio":0.7384370015948963,"block_preserve_scale":true},"created_time":1704009585663,"last_edited_time":1704010038692,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"file_ids":["a82a0cfd-1d08-445e-b3a9-382b5f601983"],"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"b1eefd68-c055-4737-919a-8dc7d906bbb6":{"value":{"id":"b1eefd68-c055-4737-919a-8dc7d906bbb6","version":2127,"type":"text","properties":{"title":[["양방향 데이터 전송이 "],["WebSocket",[["c"]]],["을 통해 이뤄진다는 점을 확인했다. 토이 프로젝트를 통해 경험해보고 싶다는 생각을 했고 간단한 채팅 애플리케이션을 떠올리게 되었다. 프로젝트를 시작하기 앞서 HTTP 통신과 관련 내용들에 대해 학습하고 정리하였으나 이번 글에서는 다루지 않을 예정이다."]]},"created_time":1704009571838,"last_edited_time":1704018844029,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"f38368c0-b452-416e-b7b9-d1be4ad095d6":{"value":{"id":"f38368c0-b452-416e-b7b9-d1be4ad095d6","version":712,"type":"text","properties":{"title":[["이 과정에서 "],["Next.js",[["c"]]],[" 13버전과 "],["Socket.io",[["c"]]],["를 활용했고 이전에 새로운 버전의 "],["Next.js",[["c"]]],[" 연습하기 위해 세팅해두었던 프로젝트에 새로운 페이지를 생성하며 시작했다."]]},"created_time":1704009800104,"last_edited_time":1704010590547,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"da7a2ef9-30ac-4c52-b2b4-6dab64164385":{"value":{"id":"da7a2ef9-30ac-4c52-b2b4-6dab64164385","version":56,"type":"sub_header","properties":{"title":[["버전 정보"]]},"created_time":1704011094489,"last_edited_time":1704011099475,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"70d2ad5a-6374-45fe-8f3a-2d02b2593784":{"value":{"id":"70d2ad5a-6374-45fe-8f3a-2d02b2593784","version":27,"type":"code","properties":{"title":[["\"next\": \"13.4.12\",\n\"socket.io\": \"^4.7.2\",\n\"socket.io-client\": \"^4.7.2\""]],"language":[["JSON"]]},"created_time":1704011133485,"last_edited_time":1704011168769,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"3d2bfca8-7478-488e-a242-7332795e7e7a":{"value":{"id":"3d2bfca8-7478-488e-a242-7332795e7e7a","version":71,"type":"header","properties":{"title":[["서버 세팅"]]},"created_time":1704009492309,"last_edited_time":1704020289635,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"9542d909-a7f0-47dd-a2c0-c2accdcb631e":{"value":{"id":"9542d909-a7f0-47dd-a2c0-c2accdcb631e","version":1491,"type":"text","properties":{"title":[["Node.js",[["c"]]],["를 통해 백엔드 서버를 직접 구현해야 한다는 점과 서버가 켜져 있어야 한다는 불편함에 "],["Next.js",[["c"]]],["의 백엔드 기능(Route Handlers)을 활용해 서버를 구축하기로 결정하게 되었다. 그리고 편의성을 제공하는 라이브러리인 "],["Socket.io",[["c"]]],["를 선택했다."]]},"created_time":1704010339748,"last_edited_time":1704011585063,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"9a8a4096-d471-45a5-b497-63510930ce65":{"value":{"id":"9a8a4096-d471-45a5-b497-63510930ce65","version":260,"type":"sub_header","properties":{"title":[["문제점1 - app router와의 호환성"]]},"created_time":1704010961077,"last_edited_time":1704011006189,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"ffb43060-ae98-4c76-b36f-cc01f6600fe6":{"value":{"id":"ffb43060-ae98-4c76-b36f-cc01f6600fe6","version":2179,"type":"text","properties":{"title":[["시작하자마자 문제가 생겼다. 13버전의 app router의 router handler와 pages router의 API routes는 다른 방법으로 코드를 작성해야 한다. "]]},"created_time":1704010875019,"last_edited_time":1704019572939,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"5fc13c6c-139c-4630-b1fc-2779caed8221":{"value":{"id":"5fc13c6c-139c-4630-b1fc-2779caed8221","version":71,"type":"code","properties":{"title":[["// Route Handlers\nexport async function GET(request: Request) {}"]],"language":[["JavaScript"]]},"created_time":1704012373615,"last_edited_time":1704020083153,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"4bcede9a-64e7-4e86-b347-4ce9d01c896a":{"value":{"id":"4bcede9a-64e7-4e86-b347-4ce9d01c896a","version":197,"type":"code","properties":{"title":[["// API routes\nexport default function handler(req, res) {}"]],"language":[["JavaScript"]]},"created_time":1704012250879,"last_edited_time":1704020088792,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"43c8efef-918d-4ba8-a579-5770e98f1b7e":{"value":{"id":"43c8efef-918d-4ba8-a579-5770e98f1b7e","version":160,"type":"text","properties":{"title":[["우선 pages router의 "],["API Routes를 활용한 방법을 채택",[["b"]]],["하고 구현하게 되었다. "]]},"created_time":1704014235898,"last_edited_time":1704014587053,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"d88ed033-7441-4371-b666-c49665d2332d":{"value":{"id":"d88ed033-7441-4371-b666-c49665d2332d","version":311,"type":"quote","properties":{"title":[["이유 1 - "],["Next.js",[["c"]]],["와 "],["Socket.io",[["c"]]],["를 연결할 방법이 없다."]]},"created_time":1704014458202,"last_edited_time":1704014596121,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"8b184e9a-7eaf-40ed-b0c3-6bf57f87643e":{"value":{"id":"8b184e9a-7eaf-40ed-b0c3-6bf57f87643e","version":1402,"type":"text","properties":{"title":[["코드를 작성하며 느꼈던 문제는 Next의 서버 인스턴스를 받아 이를 "],["Socket.io",[["c"]]],["와 연결해야 하는데 그 방법이 제공되지 않는다는 점이였다. 반면 handler의 res를 사용하면 서버의 인스턴스에 접근할 수 있었다."]]},"created_time":1704012245797,"last_edited_time":1704014648642,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"d4f2f6d4-3f24-43af-b1f7-578401a543e4":{"value":{"id":"d4f2f6d4-3f24-43af-b1f7-578401a543e4","version":18,"type":"quote","properties":{"title":[["이유 2 - "],["Socket.io",[["c"]]],["와 제대로 호환되지 않는다."]]},"created_time":1704014546113,"last_edited_time":1704014572327,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"629c0e29-a4b5-4352-9b0f-83d5c85b2939":{"value":{"id":"629c0e29-a4b5-4352-9b0f-83d5c85b2939","version":5,"type":"text","properties":{"title":[["추후 서버 연결이 아닌 POST를 처리하는 과정에서도 다시 한번 Route Handlers를 사용해봤으나 역시 호환이 제대로 되지 않아 문제가 발생했다."]]},"created_time":1704014234334,"last_edited_time":1704014234337,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"1b299f0e-0f97-425c-b07e-37fc90b83f0d":{"value":{"id":"1b299f0e-0f97-425c-b07e-37fc90b83f0d","version":127,"type":"sub_sub_header","properties":{"title":[["구현 with TS"]]},"created_time":1704012212981,"last_edited_time":1704014670723,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"c3803ca8-ce20-499c-944d-c28cdc9f2f4e":{"value":{"id":"c3803ca8-ce20-499c-944d-c28cdc9f2f4e","version":75,"type":"code","properties":{"title":[["// pages/api/socket/io.ts\nimport {Server as NetServer} from 'http';\nimport {Socket} from 'net';\nimport {NextApiRequest, NextApiResponse} from 'next';\nimport {Server as ServerIO} from 'socket.io';\n\nimport {ServerToClientEvents} from '@/types/socket';\n\nexport type NextApiResponseServerIO = NextApiResponse \u0026 {\n  socket: Socket \u0026 {\n    server: NetServer \u0026 {\n      io: ServerIO\u003cServerToClientEvents\u003e;\n    };\n  };\n};\n\nconst ioHandler = (req: NextApiRequest, res: NextApiResponseServerIO) =\u003e {\n  if (!res.socket.server.io) {\n    const httpServer = res.socket.server as NetServer;\n    const io = new ServerIO(httpServer, {\n      path: '/api/socket/io',\n      addTrailingSlash: false,\n    });\n\n    res.socket.server.io = io;\n  }\n\n  res.end();\n};\n\nexport default ioHandler;"]],"language":[["JavaScript"]]},"created_time":1704014318344,"last_edited_time":1704014356566,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"b2cc77f9-9368-48c3-bbe0-ffed23f88cd6":{"value":{"id":"b2cc77f9-9368-48c3-bbe0-ffed23f88cd6","version":637,"type":"text","properties":{"title":[["Socket.io",[["c"]]],["에 타입스크립트를 적용하기 위해서는 공식 문서를 참고하는 것을 추천드린다. 따로 타입을 지정함으로 자동완성이나 에러를 쉽게 발견할 수 있었다."]]},"created_time":1704012218437,"last_edited_time":1704014747920,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"f21ff6bf-f274-42f4-9919-b375257a7e3f":{"value":{"id":"f21ff6bf-f274-42f4-9919-b375257a7e3f","version":26,"type":"text","properties":{"title":[["https://socket.io/docs/v4/typescript/",[["a","https://socket.io/docs/v4/typescript/"]]]]},"created_time":1704014765060,"last_edited_time":1704014771534,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"ef4d44b6-1e2d-41b0-adcb-76ba25a53f1e":{"value":{"id":"ef4d44b6-1e2d-41b0-adcb-76ba25a53f1e","version":70,"type":"header","properties":{"title":[["클라이언트 구현"]]},"created_time":1704010063403,"last_edited_time":1704010067168,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"f89f49e2-98de-4ad5-b81b-84b70c9a241a":{"value":{"id":"f89f49e2-98de-4ad5-b81b-84b70c9a241a","version":1643,"type":"text","properties":{"title":[["간단한 애플리케이션이기에 상태 관리 라이브러리를 활용하는 것보다는 "],["Context API",[["c"]]],["와 커스텀훅을 활용했다."]]},"created_time":1704014789661,"last_edited_time":1704016948662,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"b65740fa-916c-4d35-a668-e3c2fd5125c6":{"value":{"id":"b65740fa-916c-4d35-a668-e3c2fd5125c6","version":69,"type":"text","properties":{"title":[["context로 구현하고 싶은신 분들을 위해 링크로 빼겠습니다."]]},"created_time":1704015623479,"last_edited_time":1704015632486,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"6f5d0110-c34d-42ca-b7af-54fa90a1217a":{"value":{"id":"6f5d0110-c34d-42ca-b7af-54fa90a1217a","version":6,"type":"text","properties":{"title":[["https://github.com/mxx-kor/nextjs-practice/blob/main/components/provider/SocketProvider.tsx",[["a","https://github.com/mxx-kor/nextjs-practice/blob/main/components/provider/SocketProvider.tsx"]]]]},"created_time":1704015308721,"last_edited_time":1704015310458,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"ac2a61e2-d882-4925-8805-df86390e2860":{"value":{"id":"ac2a61e2-d882-4925-8805-df86390e2860","version":379,"type":"sub_header","properties":{"title":[["연결 관련 이벤트 등록"]]},"created_time":1704016655315,"last_edited_time":1704016805997,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"20401204-2646-418a-8309-cf106cfc6b6d":{"value":{"id":"20401204-2646-418a-8309-cf106cfc6b6d","version":164,"type":"code","properties":{"title":[["// component/provider/SocketProvider.tsx\n\n'use client';\n\n...\n\nexport const SocketProvider = ({children}: {children: React.ReactNode}) =\u003e {\n  const [socket, setSocket] = useState\u003cClientSocketType | null\u003e(null);\n  const [isConnected, setIsConnected] = useState(false);\n\n  useEffect(() =\u003e {\n    const socket: ClientSocketType = io(process.env.NEXT_PUBLIC_SITE_URL!, {\n      path: '/api/socket/io',\n      addTrailingSlash: false,\n    });\n\n    socket.on('connect', () =\u003e {\n      setIsConnected(true);\n    });\n\n    socket.on('error', (error: Error) =\u003e {\n      console.error(error);\n    });\n\n    socket.on('disconnect', () =\u003e {\n      setIsConnected(false);\n    });\n\n    setSocket(socket);\n\n    return () =\u003e {\n      if (socket) {\n        socket.disconnect();\n      }\n    };\n  }, []);\n\n  ...\n};"]],"language":[["JavaScript"]]},"created_time":1704015071778,"last_edited_time":1704015387486,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"1ef8c491-af73-49cf-a455-60562d0a6a6f":{"value":{"id":"1ef8c491-af73-49cf-a455-60562d0a6a6f","version":1171,"type":"text","properties":{"title":[["서버와 클라이언트가 연결되면 이벤트를 등록하고 chat 페이지에만 socket을 사용하고 있어 해당 페이지의 layout에 provider로 감싸주었다. 그리고 언마운트되면 cleanup function을 통해 정리하도록 구현했다. 제대로 연결되는지 인디케이터를 만들어서 확인해봤다."]]},"created_time":1704015603215,"last_edited_time":1704016633862,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"5e0c2e4a-77f5-481c-a63a-6bbe912284d1":{"value":{"id":"5e0c2e4a-77f5-481c-a63a-6bbe912284d1","version":96,"type":"image","properties":{"size":[["7.7KB"]],"title":[["Dec-31-2023 18-54-56.gif"]],"source":[["https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/77707b92-c606-4323-986d-c71ae3855f3d/Dec-31-2023_18-54-56.gif"]],"caption":[["인디케이터로 동작 확인"]]},"format":{"block_width":264,"block_height":94,"display_source":"https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/77707b92-c606-4323-986d-c71ae3855f3d/Dec-31-2023_18-54-56.gif","block_full_width":false,"block_page_width":false,"block_aspect_ratio":0.3560606060606061,"block_preserve_scale":true},"created_time":1704016517774,"last_edited_time":1704016620286,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"file_ids":["77707b92-c606-4323-986d-c71ae3855f3d"],"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"f8a5f085-a145-42c6-8186-f3ecd665bd92":{"value":{"id":"f8a5f085-a145-42c6-8186-f3ecd665bd92","version":107,"type":"sub_header","properties":{"title":[["메시지 이벤트"]]},"created_time":1704016411276,"last_edited_time":1704016812605,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"16dbcbdb-f5a5-4abe-b672-55132bdbf9ad":{"value":{"id":"16dbcbdb-f5a5-4abe-b672-55132bdbf9ad","version":899,"type":"text","properties":{"title":[["socket을 활용한 다른 기능 활용시 메시지 이벤트를 등록하지 않아도 되는지 확인하고 싶어서 chat 페이지에서 이벤트를 등록하는 방법을 활용해봤다. "]]},"created_time":1704016813298,"last_edited_time":1704017090507,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"51ffbb77-dfea-4743-8382-18267194d226":{"value":{"id":"51ffbb77-dfea-4743-8382-18267194d226","version":58,"type":"code","properties":{"title":[["'use client';\n\n...\n\nimport {useSocket} from '@/components/provider/SocketProvider';\nimport {IMessage} from '@/types/chat';\n\nconst Chat = () =\u003e {\n  const {socket} = useSocket();\n  const [messages, setMessages] = useState\u003cIMessage[]\u003e([]);\n\t...\n\n  const sendMessage = async () =\u003e {\n    if (currentMessage) {\n      const res = await fetch('/api/chat', {\n        method: 'POST',\n        body: JSON.stringify({\n          user: username,\n          content: currentMessage,\n        }),\n      });\n\n      if (res.ok) setCurrentMessage('');\n    }\n  };\n\n  useEffect(() =\u003e {\n    socket?.on('message', (message: IMessage) =\u003e {\n      setMessages((prev) =\u003e [...prev, message]);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [socket]);\n\n\t...\n\nexport default Chat;"]],"language":[["JavaScript"]]},"created_time":1704016890296,"last_edited_time":1704017099515,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"62017d3d-453a-4735-a78d-5109c1a23a0e":{"value":{"id":"62017d3d-453a-4735-a78d-5109c1a23a0e","version":1349,"type":"text","properties":{"title":[["message를 송수신할 수 있는 이벤트를 socket이 연결되어 있을때 등록하고 상태를 변경하는 방법으로 화면에 표시할 수 있었고 "],["sendMessage",[["c"]]],["함수의 Post 요청을 처리하는 부분의 코드는 아래와 같다."]]},"created_time":1704015715144,"last_edited_time":1704017336284,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"658aaa8f-8657-4e98-8c36-8e7ede8169e2":{"value":{"id":"658aaa8f-8657-4e98-8c36-8e7ede8169e2","version":41,"type":"sub_sub_header","properties":{"title":[["chatHandler"]]},"created_time":1704018163546,"last_edited_time":1704018180008,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"d0f758ed-c005-4f6e-a50c-55fa6ddbcc4e":{"value":{"id":"d0f758ed-c005-4f6e-a50c-55fa6ddbcc4e","version":69,"type":"code","properties":{"title":[["// pages/api/chat.ts\nimport {NextApiRequest} from 'next';\nimport {IMessage} from '@/types/chat';\nimport {NextApiResponseServerIO} from './socket/io';\n\nconst chatHandler = (req: NextApiRequest, res: NextApiResponseServerIO) =\u003e {\n  if (req.method === 'POST') {\n    const message = JSON.parse(req.body) as IMessage;\n\n    res.socket.server.io.emit('message', message);\n\n    res.status(201).json(message);\n  }\n};\n\nexport default chatHandler;"]],"language":[["JavaScript"]]},"created_time":1704017286205,"last_edited_time":1704017945422,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"70880d43-c92f-4a57-bc7c-8bde14421ad7":{"value":{"id":"70880d43-c92f-4a57-bc7c-8bde14421ad7","version":118,"type":"quote","properties":{"title":[["또 다른 handler를 작성한 이유"]]},"created_time":1704018041291,"last_edited_time":1704018053491,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"8b49c436-a0c8-4a5b-b36b-f6da55c2641f":{"value":{"id":"8b49c436-a0c8-4a5b-b36b-f6da55c2641f","version":738,"type":"text","properties":{"title":[[" "],["sendMessage",[["c"]]],[" 안에서 바로 emit을 하는 경우에는 아무 동작도 이루어지지 않는 점 때문이였다. 추론이지만 네트워크 동작을 통해서만 Socket에 접근하고 이벤트를 발생시킬 수 있다고 생각하게 되었다."]]},"created_time":1704017882066,"last_edited_time":1704018151418,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"2e0bedf7-0c42-4487-88cd-e9132bdbd9f3":{"value":{"id":"2e0bedf7-0c42-4487-88cd-e9132bdbd9f3","version":52,"type":"header","properties":{"title":[["결과물"]]},"created_time":1704020195751,"last_edited_time":1704020223461,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"3d58c4dc-2f7c-4ad2-8b86-6aebf74f7564":{"value":{"id":"3d58c4dc-2f7c-4ad2-8b86-6aebf74f7564","version":581,"type":"text","properties":{"title":[["3개의 브라우저를 띄우고 메시지를 보내보았다. 나름 이쁜 결과물을 만들기 위해 "],["Mui",[["c"]]],["를 활용했다."]]},"created_time":1704018235714,"last_edited_time":1704019236508,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"be9fc36c-15ec-44f6-b258-c0c562e7bdfa":{"value":{"id":"be9fc36c-15ec-44f6-b258-c0c562e7bdfa","version":12,"type":"image","properties":{"size":[["137.4KB"]],"title":[["Dec-31-2023 19-31-57.gif"]],"source":[["https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/67868ee4-7a01-4ba4-ad82-675257343532/Dec-31-2023_19-31-57.gif"]]},"format":{"block_width":640,"block_height":316,"display_source":"https://prod-files-secure.s3.us-west-2.amazonaws.com/7b0c1ebf-29f7-4bde-9810-55e79a3d582e/67868ee4-7a01-4ba4-ad82-675257343532/Dec-31-2023_19-31-57.gif","block_full_width":false,"block_page_width":false,"block_aspect_ratio":0.49375,"block_preserve_scale":true},"created_time":1704018732538,"last_edited_time":1704018736855,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"file_ids":["67868ee4-7a01-4ba4-ad82-675257343532"],"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"306d9cc6-fa66-4875-9e5f-78793683c222":{"value":{"id":"306d9cc6-fa66-4875-9e5f-78793683c222","version":2048,"type":"header","properties":{"title":[["마치며"]]},"created_time":1704018807352,"last_edited_time":1704020266188,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"6f616937-d452-4b2c-a566-9a3939849c75":{"value":{"id":"6f616937-d452-4b2c-a566-9a3939849c75","version":5,"type":"text","properties":{"title":[["궁금증으로 시작한 토이 프로젝트가 HTTP 통신에 대한 학습, "],["Next.js",[["c"]]],["의 serverless 백엔드 활용까지 다양한 경험을 이끌게 되었다. 초반에 걱정했던 "],["WebSocket",[["c"]]],["과 "],["Socket.io",[["c"]]],["의 차이점 중 하나인 속도 면에서도 나쁘지 않은 성능을 보여주었다. 신경썼던 타입 적용도 잘 이루어졌다."]]},"created_time":1704018807352,"last_edited_time":1704020229690,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"33d18b15-67ab-43d5-833d-4aea07b8dfd2":{"value":{"id":"33d18b15-67ab-43d5-833d-4aea07b8dfd2","version":1799,"type":"text","properties":{"title":[["지금은 정말 간단한 채팅이지만 추후 Figma처럼 공동 작업이나 아예 새로운 기능을 구현해보고 싶다."]]},"created_time":1704019376191,"last_edited_time":1704020262547,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"},"8723e867-5e86-41aa-89c0-20230a07b30c":{"value":{"id":"8723e867-5e86-41aa-89c0-20230a07b30c","version":4,"type":"text","created_time":1704019967502,"last_edited_time":1704019967505,"parent_id":"1470f218-8382-4dfb-bd46-defda19e2bda","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","last_edited_by_table":"notion_user","last_edited_by_id":"b3d94135-cbdf-428e-a8a5-8801e91b70e6","space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"}},"collection":{"77251464-f92c-498c-8ec6-b1ee5950601b":{"value":{"id":"77251464-f92c-498c-8ec6-b1ee5950601b","version":82,"name":[["포스팅"]],"schema":{"H`Il":{"name":"Main","type":"checkbox"},"LkE\u003e":{"name":"Summary","type":"text"},"Q[~X":{"name":"Tags","type":"multi_select","options":[{"id":"036731bb-69f1-47c2-899c-76ebd0c4c21d","color":"purple","value":"Next.js"},{"id":"e30a7966-4eb2-45a7-b1f3-314cd0d2c5b0","color":"default","value":"TailwindCSS"},{"id":"f1dcbd9b-69e5-4564-99d8-b65fb51b0090","color":"gray","value":"브라우저"},{"id":"dcc8bb71-28e8-4ef7-8f0b-1922c0daf129","color":"brown","value":"React"},{"id":"3ee98ab1-0b9d-430b-93da-cf2a2ca2f036","color":"pink","value":"lighthouse"},{"id":"eef9ed94-f853-4b17-a817-2ac412387220","color":"orange","value":"회고"},{"id":"15f9af90-4308-4dba-acf4-1565f1b3108b","color":"red","value":"팀 프로젝트"},{"id":"75511c74-11a3-492e-ac8a-8150f5e072b2","color":"green","value":"CS"},{"id":"7982bf8b-df3e-4377-b1b9-84dc37c9ec2b","color":"default","value":"개인 프로젝트"},{"id":"73ce9024-d165-44c8-8821-c0808ab04cb9","color":"yellow","value":"프론트엔드"},{"id":"4865bdba-a3d4-48bd-83a7-7458b532dc9e","color":"default","value":"metrics"},{"id":"755884b4-bddc-4cb4-9bc8-84d0d5d29955","color":"blue","value":"flushSync"},{"id":"69e1ad87-e25d-44b0-865a-be86ed1589c4","color":"blue","value":"JavaScript"},{"id":"b7b6126d-26cf-4a98-8057-873aad8b6cd4","color":"pink","value":"Notion"},{"id":"2bcdc16c-6690-496f-944a-f21d1db899b6","color":"blue","value":"module"},{"id":"d5eb76a7-b5a6-4de7-976f-fa76f907595d","color":"gray","value":"함수형 프로그래밍"},{"id":"2cfb94f8-487f-4e6a-9389-2485549661fe","color":"green","value":"websocket"}]},"[eXF":{"name":"Title","type":"text"},"title":{"name":"Slug","type":"title"}},"format":{"property_visibility":[{"property":"Q[~X","visibility":"hide"},{"property":"H`Il","visibility":"hide"},{"property":"LkE\u003e","visibility":"hide"},{"property":"[eXF","visibility":"hide"}],"collection_page_properties":[{"visible":true,"property":"Q[~X"}]},"parent_id":"f49dbc55-2ac0-4786-b9e3-4b9522a6a294","parent_table":"block","alive":true,"migrated":true,"space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e","deleted_schema":{"\u003eHgf":{"name":"AI 요약","type":"text","ai_inference":{"type":"summarize","auto_update_on_edit":false}}}},"role":"reader"}},"collection_view":{"2943edd6-04c4-497c-9810-5b340d73025b":{"value":{"id":"2943edd6-04c4-497c-9810-5b340d73025b","version":37,"type":"table","format":{"table_wrap":true,"table_properties":[{"width":77,"visible":true,"property":"H`Il"},{"width":167,"visible":true,"property":"title"},{"width":200,"visible":true,"property":"[eXF"},{"width":200,"visible":true,"property":"Q[~X"},{"width":200,"visible":true,"property":"LkE\u003e"}],"collection_pointer":{"id":"77251464-f92c-498c-8ec6-b1ee5950601b","table":"collection","spaceId":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"table_frozen_column_index":-1},"parent_id":"f49dbc55-2ac0-4786-b9e3-4b9522a6a294","parent_table":"block","alive":true,"page_sort":["df5fe329-5fa8-4852-826b-441b0ca8ed95","a92f06fe-b685-4060-8fe8-6e532683cde4","f32de19b-da8d-49cb-84ce-e509b82600ce","bd0a0d15-7c73-440d-a557-47e29417f68a","08cc1d27-2908-4a9b-a1cc-38db1009da25","d9717ebe-4fc8-4fd5-9336-393fabc3574b","876b9a0c-1d3d-486b-8f7e-2e550187fbcc","0b1f8158-2ece-49da-9c00-f95c4b657a41","b3fdc8c9-3b8f-48bd-91af-5ea70ce1193d","5973748b-61e7-4d92-999e-ad082353606f","6da84544-75f7-436a-8228-8df0315ac183","549d7ee1-51ab-445e-92a9-5d9851ebd792","adc18887-c0d6-4db5-908c-873d849a02ef","babf25bd-0c2c-43d8-98d9-b85ecadd83dc","55e39890-1d23-42ad-aa73-f4fe7d545329","d370f701-4efb-4e4a-8ed5-bdcdec7a1738","6da47cc3-3384-4d52-8b34-e0cf97e5caf9","2f519016-0752-47a6-9142-08cb1d04bd10","2f3ab74d-072f-40cc-a37f-55fe452f2b78","1470f218-8382-4dfb-bd46-defda19e2bda","dfe03591-04f5-4ff9-a101-b551112d7aa0","ca40eb29-4355-4fc0-9996-a1f2df00ae3b","11ad81a4-5904-437c-a419-80ba4058c34a","55776695-9cf1-47ac-ad84-8f83bd2ecf3c","be15ca6b-9722-434e-8904-9474982454fd"],"space_id":"7b0c1ebf-29f7-4bde-9810-55e79a3d582e"},"role":"reader"}},"space":{},"notion_user":{},"collection_query":{},"signed_urls":{}},"tableOfContents":[{"id":"10dfc0a4-c763-4422-981a-c4b95a412977","type":"header","text":"서론","indentLevel":0},{"id":"da7a2ef9-30ac-4c52-b2b4-6dab64164385","type":"sub_header","text":"버전 정보","indentLevel":1},{"id":"3d2bfca8-7478-488e-a242-7332795e7e7a","type":"header","text":"서버 세팅","indentLevel":0},{"id":"9a8a4096-d471-45a5-b497-63510930ce65","type":"sub_header","text":"문제점1 - app router와의 호환성","indentLevel":1},{"id":"1b299f0e-0f97-425c-b07e-37fc90b83f0d","type":"sub_sub_header","text":"구현 with TS","indentLevel":2},{"id":"ef4d44b6-1e2d-41b0-adcb-76ba25a53f1e","type":"header","text":"클라이언트 구현","indentLevel":0},{"id":"ac2a61e2-d882-4925-8805-df86390e2860","type":"sub_header","text":"연결 관련 이벤트 등록","indentLevel":1},{"id":"f8a5f085-a145-42c6-8186-f3ecd665bd92","type":"sub_header","text":"메시지 이벤트","indentLevel":1},{"id":"658aaa8f-8657-4e98-8c36-8e7ede8169e2","type":"sub_sub_header","text":"chatHandler","indentLevel":2},{"id":"2e0bedf7-0c42-4487-88cd-e9132bdbd9f3","type":"header","text":"결과물","indentLevel":0},{"id":"306d9cc6-fa66-4875-9e5f-78793683c222","type":"header","text":"마치며","indentLevel":0}]},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"websocket-with-nextjs"},"buildId":"DB43IG3Rp7SS1b-GPkLIQ","isFallback":false,"dynamicIds":[635,1794],"gsp":true,"scriptLoader":[]}</script></body></html>